ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"foc.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.global	__aeabi_f2d
  18              		.global	__aeabi_dmul
  19              		.global	__aeabi_dsub
  20              		.global	__aeabi_d2f
  21              		.section	.text.Get_Speed,"ax",%progbits
  22              		.align	1
  23              		.arch armv7e-m
  24              		.syntax unified
  25              		.thumb
  26              		.thumb_func
  27              		.fpu fpv4-sp-d16
  29              	Get_Speed:
  30              	.LFB179:
  31              		.file 1 "Src/foc.c"
   1:Src/foc.c     **** #include "tim.h"
   2:Src/foc.c     **** #include "main.h"
   3:Src/foc.c     **** #include "adc.h"
   4:Src/foc.c     **** #include "uart_ext.h"
   5:Src/foc.c     **** #include "foc.h"
   6:Src/foc.c     **** #include "math.h"
   7:Src/foc.c     **** #include "as5047.h"
   8:Src/foc.c     **** #include "SVPWM.h"
   9:Src/foc.c     **** #include "arm_math.h"
  10:Src/foc.c     **** 
  11:Src/foc.c     **** #include "gpio.h"
  12:Src/foc.c     **** #include "utils.h"
  13:Src/foc.c     **** 
  14:Src/foc.c     **** 
  15:Src/foc.c     **** #define CURRENT_ADC ADC1
  16:Src/foc.c     **** /**
  17:Src/foc.c     ****  * A simple low pass filter.
  18:Src/foc.c     ****  *
  19:Src/foc.c     ****  * @param value
  20:Src/foc.c     ****  * The filtered value.
  21:Src/foc.c     ****  *
  22:Src/foc.c     ****  * @param sample
  23:Src/foc.c     ****  * Next sample.
  24:Src/foc.c     ****  *
  25:Src/foc.c     ****  * @param filter_constant
  26:Src/foc.c     ****  * Filter constant. Range 0.0 to 1.0, where 1.0 gives the unfiltered value.
  27:Src/foc.c     ****  */
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 2


  28:Src/foc.c     **** #define UTILS_LP_FAST(value, sample, filter_constant)	(value -= (filter_constant) * (value - (sampl
  29:Src/foc.c     **** #define FOC_STOP() Set_Vector(U0,0.1f) 
  30:Src/foc.c     **** inline void Check_Mode();
  31:Src/foc.c     **** static void Get_Speed();
  32:Src/foc.c     **** 
  33:Src/foc.c     **** float Base_Speed=1500.0f;
  34:Src/foc.c     **** float Speed_Attitude=500.0f;
  35:Src/foc.c     **** 
  36:Src/foc.c     **** float Base_Duty= 0.1f;
  37:Src/foc.c     **** float Duty_Amp = 0.0f;
  38:Src/foc.c     **** 
  39:Src/foc.c     **** 
  40:Src/foc.c     **** 
  41:Src/foc.c     **** int16_t Position;
  42:Src/foc.c     **** float Position_Degree;
  43:Src/foc.c     **** float Position_Degree_Set;
  44:Src/foc.c     **** float Position_Phase_Degree; // ÁîµËßíÂ∫¶
  45:Src/foc.c     **** 
  46:Src/foc.c     **** float Speed;
  47:Src/foc.c     **** float Speed_Set=3000.0f;  // Âçï‰ΩçÔºöÊú∫Ê¢∞ËßíÂ∫¶/s
  48:Src/foc.c     **** //float Position_Phase_Offset=116.587318f; // ÁîµËßíÂ∫¶ÁöÑÂÅèÁßªÔºàÁºñÁ†ÅÂô®‰∏éÁîµËßíÂ∫¶ÂØπÈΩêÔºâ
  49:Src/foc.c     **** 
  50:Src/foc.c     **** int16_t current_adc_value[3]={0};
  51:Src/foc.c     **** int16_t current_adc_offset[2]={0};
  52:Src/foc.c     **** float current[2]={0};
  53:Src/foc.c     **** float input_voltage=0;
  54:Src/foc.c     **** float ialpha,ibeta,id,iq;
  55:Src/foc.c     **** 
  56:Src/foc.c     **** Motor_Parameter Motor = {7, 123.748848f, 0};
  57:Src/foc.c     **** Mode Board_Mode=DUTY;
  58:Src/foc.c     **** Mode Last_Mode=DUTY;
  59:Src/foc.c     **** 
  60:Src/foc.c     **** //uint8_t Encoder_Direction = 0;
  61:Src/foc.c     **** 
  62:Src/foc.c     **** float Id_Set=0;
  63:Src/foc.c     **** float Iq_Set=0.6f;
  64:Src/foc.c     **** 
  65:Src/foc.c     **** float Phi = 90;
  66:Src/foc.c     **** float Position_Offset = 132; 
  67:Src/foc.c     **** // This var is used to align the offset of propeller. ÊóãÁøºÂ§¥ÁöÑÈõ∂ÁÇπ
  68:Src/foc.c     **** // ÂÆö‰πâËØ•Èõ∂ÁÇπ‰∏∫
  69:Src/foc.c     **** /*
  70:Src/foc.c     **** 
  71:Src/foc.c     ****         /------------------/
  72:Src/foc.c     ****       /------------------/
  73:Src/foc.c     ****     /------------------/
  74:Src/foc.c     ****   /------------------/
  75:Src/foc.c     **** 
  76:Src/foc.c     **** */
  77:Src/foc.c     **** 
  78:Src/foc.c     **** PID_S Id_PID ={
  79:Src/foc.c     ****     .KP=2,
  80:Src/foc.c     ****     .KD=0,
  81:Src/foc.c     ****     .KI=2,
  82:Src/foc.c     ****     .I_TIME=  1.0f/FOC_FREQ,
  83:Src/foc.c     ****     .i_max = __FLT_MAX__,
  84:Src/foc.c     ****     .I_ERR_LIMIT = 0.3f
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 3


  85:Src/foc.c     ****     };
  86:Src/foc.c     **** PID_S Iq_PID = {
  87:Src/foc.c     ****     .KP=2,
  88:Src/foc.c     ****     .KD=0,
  89:Src/foc.c     ****     .KI=1.5,
  90:Src/foc.c     ****     .I_TIME=  1.0f/FOC_FREQ,
  91:Src/foc.c     ****     .i_max = __FLT_MAX__,
  92:Src/foc.c     ****     .I_ERR_LIMIT = 0.3f
  93:Src/foc.c     ****     }; // ÂêØÂä®ÁîµÊµÅÊå∫Â§ßÁöÑ
  94:Src/foc.c     **** 
  95:Src/foc.c     **** PID_S Speed_PID={
  96:Src/foc.c     ****     .KP=0.00045f,
  97:Src/foc.c     ****     .KD=0,
  98:Src/foc.c     ****     .KI=0.00015f,
  99:Src/foc.c     ****     .I_TIME= 1.0f/SPEED_FREQ,
 100:Src/foc.c     ****     .i_max = __FLT_MAX__,
 101:Src/foc.c     ****     .I_ERR_LIMIT =  2000
 102:Src/foc.c     ****     };
 103:Src/foc.c     **** 
 104:Src/foc.c     **** PID_S Position_PID={
 105:Src/foc.c     ****     .KP=20,
 106:Src/foc.c     ****     .KD=0,
 107:Src/foc.c     ****     .KI=0.1,
 108:Src/foc.c     ****     .I_TIME=1.0f/POSITION_FREQ,
 109:Src/foc.c     ****     .i_max = __FLT_MAX__,
 110:Src/foc.c     ****     .I_ERR_LIMIT = 5 
 111:Src/foc.c     ****     };
 112:Src/foc.c     **** uint8_t FOC_Flag=0;
 113:Src/foc.c     **** 
 114:Src/foc.c     **** static void Speed_Control();
 115:Src/foc.c     **** static void Position_Control();
 116:Src/foc.c     **** 
 117:Src/foc.c     **** void PID_I_Clear(){
 118:Src/foc.c     ****     Iq_PID.i=0;
 119:Src/foc.c     ****     Id_PID.i=0;
 120:Src/foc.c     ****     Speed_PID.i=0;
 121:Src/foc.c     ****     Position_PID.i=0;
 122:Src/foc.c     **** }
 123:Src/foc.c     **** 
 124:Src/foc.c     **** // ËØ•ÂáΩÊï∞Áî®‰∫éÂ§ÑÁêÜÊöóÂÆ§ÈïøÊõùÂÖâÈ¢ëÈó™
 125:Src/foc.c     **** // exposure_time:ÊõùÂÖâÊó∂Èó¥,Âçï‰Ωç:s
 126:Src/foc.c     **** // flash_time:Èó™ÂÖâÊó∂Èó¥,Âçï‰Ωç:ms
 127:Src/foc.c     **** #ifdef CAMERA_SUPPORT
 128:Src/foc.c     **** 
 129:Src/foc.c     **** uint8_t CAMERA_Open=1;
 130:Src/foc.c     **** float Camera_Catch_Angle=90;
 131:Src/foc.c     **** #define CAMERA_POS_ERROR 1
 132:Src/foc.c     **** void Camera_Exposure(uint32_t exposure_time,float flash_time,float pos){
 133:Src/foc.c     ****     static int cnt=0;
 134:Src/foc.c     ****     if(!CAMERA_Open){
 135:Src/foc.c     ****         return ;
 136:Src/foc.c     ****     }
 137:Src/foc.c     ****     float angle = Position_Degree - Position_Offset;
 138:Src/foc.c     ****     if(angle<0){
 139:Src/foc.c     ****         angle+=360;
 140:Src/foc.c     ****     }
 141:Src/foc.c     ****     if(fabsf(angle-pos)<CAMERA_POS_ERROR && cnt==0){
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 4


 142:Src/foc.c     ****         HAL_GPIO_WritePin(CAMERA_EXP_GPIO_Port,CAMERA_EXP_PIN,GPIO_PIN_SET);
 143:Src/foc.c     ****         cnt++;
 144:Src/foc.c     ****         return ;
 145:Src/foc.c     ****     }
 146:Src/foc.c     **** 
 147:Src/foc.c     ****     if(cnt==(uint32_t)(FOC_FREQ/1000*flash_time)){
 148:Src/foc.c     ****         HAL_GPIO_WritePin(CAMERA_EXP_GPIO_Port,CAMERA_EXP_PIN,GPIO_PIN_RESET); 
 149:Src/foc.c     ****     }else if(cnt==FOC_FREQ*exposure_time){
 150:Src/foc.c     ****         cnt=0;
 151:Src/foc.c     ****     }
 152:Src/foc.c     **** 
 153:Src/foc.c     ****     if(cnt>0){
 154:Src/foc.c     ****         cnt++;
 155:Src/foc.c     ****     }
 156:Src/foc.c     **** }
 157:Src/foc.c     **** #endif
 158:Src/foc.c     **** 
 159:Src/foc.c     **** 
 160:Src/foc.c     **** void Current_ADC_Init(int times){
 161:Src/foc.c     ****     int32_t curr_sum[2]={0};
 162:Src/foc.c     ****     #ifdef DRV8302
 163:Src/foc.c     ****     HAL_GPIO_WritePin(DC_CAL_GPIO_Port,DC_CAL_Pin,GPIO_PIN_SET);
 164:Src/foc.c     ****     #endif
 165:Src/foc.c     ****     HAL_Delay(10);
 166:Src/foc.c     ****     for(int i=0;i<times;++i){
 167:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 168:Src/foc.c     ****         curr_sum[1]+=current_adc_value[1];
 169:Src/foc.c     ****         HAL_Delay(1);
 170:Src/foc.c     ****     }
 171:Src/foc.c     **** 
 172:Src/foc.c     ****     current_adc_offset[0]=curr_sum[0]/times;
 173:Src/foc.c     ****     current_adc_offset[1]=curr_sum[1]/times;
 174:Src/foc.c     **** 
 175:Src/foc.c     ****    #ifdef DRV8302
 176:Src/foc.c     ****    HAL_GPIO_WritePin(DC_CAL_GPIO_Port,DC_CAL_Pin,GPIO_PIN_RESET); 
 177:Src/foc.c     ****    #endif
 178:Src/foc.c     ****    uprintf_polling("the offset of curr_adc is %d,%d\r\n",current_adc_offset[0],current_adc_offset[1
 179:Src/foc.c     **** 
 180:Src/foc.c     **** }
 181:Src/foc.c     **** 
 182:Src/foc.c     **** void Foc_Init(){
 183:Src/foc.c     ****   AS5047_Set_Direction(Motor.Encoder_Direction);
 184:Src/foc.c     ****   HAL_ADC_Start_DMA(&hadc1,current_adc_value,3);
 185:Src/foc.c     **** 
 186:Src/foc.c     ****   HAL_TIM_Base_Start(&htim8);
 187:Src/foc.c     **** 
 188:Src/foc.c     ****    //TIM1->RCR=1;
 189:Src/foc.c     ****   HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_1);
 190:Src/foc.c     ****   HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_2);
 191:Src/foc.c     ****   HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_3);
 192:Src/foc.c     **** 
 193:Src/foc.c     ****   HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_1);
 194:Src/foc.c     ****   HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_2);
 195:Src/foc.c     ****   HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_3);
 196:Src/foc.c     **** 
 197:Src/foc.c     ****   #ifdef DRV8302
 198:Src/foc.c     ****     HAL_GPIO_WritePin(EN_GATE_GPIO_Port,EN_GATE_Pin,GPIO_PIN_SET);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 5


 199:Src/foc.c     ****   #endif
 200:Src/foc.c     ****   Current_ADC_Init(20);
 201:Src/foc.c     **** 
 202:Src/foc.c     ****   HAL_NVIC_SetPriority(DMA2_Stream0_IRQn, 0, 0);
 203:Src/foc.c     ****   HAL_NVIC_EnableIRQ(DMA2_Stream0_IRQn);
 204:Src/foc.c     ****   /* DMA2_Stream2_IRQn interrupt configuration */
 205:Src/foc.c     ****   HAL_NVIC_SetPriority(DMA2_Stream2_IRQn, 0, 0);
 206:Src/foc.c     ****   HAL_NVIC_EnableIRQ(DMA2_Stream2_IRQn);
 207:Src/foc.c     **** 
 208:Src/foc.c     ****   HAL_TIM_Base_Start_IT(&htim7);
 209:Src/foc.c     **** }
 210:Src/foc.c     **** 
 211:Src/foc.c     **** #define SQRT3    1.73205080756887719000f
 212:Src/foc.c     **** #define SQRT3_2  0.866025403784438595f
 213:Src/foc.c     **** void Clark_Conv(float ia, float ic, float *ialpha, float *ibeta)
 214:Src/foc.c     **** {
 215:Src/foc.c     ****     ia= -ia;
 216:Src/foc.c     ****     ic= -ic;
 217:Src/foc.c     ****     // ‰∏∫‰ªÄ‰πàËøôÈáåË¶ÅÂä†Ë¥üÂè∑Âë¢
 218:Src/foc.c     ****     // Âõ†‰∏∫ÁîµÊµÅÁöÑÊ≠£Ë¥üÊ†πÊçÆÁõ∏ÁîµÊµÅÁöÑÊñπÂêë‰∏∫Ê≠£ÔºåÂ¶ÇU4ÔºàABC 100ÔºâÔºåÊ≠§Êó∂AÁöÑÁîµÊµÅ‰
 219:Src/foc.c     ****     // ‰∏éÁ°¨‰ª∂‰∏äÁöÑÊ≠£Ë¥üÁõ∏Âèç
 220:Src/foc.c     **** 
 221:Src/foc.c     ****     float ib = -(ia+ic);
 222:Src/foc.c     ****     *ialpha = 1.5f*ia;
 223:Src/foc.c     ****     *ibeta = SQRT3_2 * ib + SQRT3_2* (ib + ia);
 224:Src/foc.c     **** }
 225:Src/foc.c     **** 
 226:Src/foc.c     **** void Park_Conv(float ialpha,float ibeta,float theta,float *iq,float *id){
 227:Src/foc.c     ****     float sin,cos;
 228:Src/foc.c     ****     sin=cos=0;
 229:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 230:Src/foc.c     ****     *id = ialpha * cos + ibeta *sin;
 231:Src/foc.c     ****     *iq = -ialpha *sin + ibeta *cos;
 232:Src/foc.c     **** }
 233:Src/foc.c     **** 
 234:Src/foc.c     **** void Reverse_Park_Conv(float q,float d,float theta,float *alpha,float *beta){
 235:Src/foc.c     ****     float sin,cos;
 236:Src/foc.c     ****     sin=cos=0;
 237:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 238:Src/foc.c     ****     *beta = d*sin + q*cos;
 239:Src/foc.c     ****     *alpha = d*cos -q*sin;
 240:Src/foc.c     **** }
 241:Src/foc.c     **** 
 242:Src/foc.c     **** void Current_Control(){
 243:Src/foc.c     ****     float Ud=PID_Control(&Id_PID,Id_Set,id);
 244:Src/foc.c     ****     float Uq=PID_Control(&Iq_PID,Iq_Set,iq);
 245:Src/foc.c     **** 
 246:Src/foc.c     ****     float Ualpha,Ubeta;
 247:Src/foc.c     ****     Reverse_Park_Conv(Uq,Ud,Position_Phase_Degree,&Ualpha,&Ubeta);
 248:Src/foc.c     ****     float target_theta= atan2f(Ubeta,Ualpha)*180.0f/3.1415926f;
 249:Src/foc.c     ****     if(target_theta<0){
 250:Src/foc.c     ****         target_theta+=360;
 251:Src/foc.c     ****     }
 252:Src/foc.c     ****     float length = sqrtf(Ualpha*Ualpha+Ubeta*Ubeta);
 253:Src/foc.c     ****     
 254:Src/foc.c     ****     if(length>8){
 255:Src/foc.c     ****         length=8;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 6


 256:Src/foc.c     ****     }
 257:Src/foc.c     ****     
 258:Src/foc.c     **** 
 259:Src/foc.c     ****     float phase=(int)Position_Phase_Degree%360;
 260:Src/foc.c     ****     //SVPWM(Position_Phase_Degree+90,0.1);
 261:Src/foc.c     **** 
 262:Src/foc.c     ****     
 263:Src/foc.c     ****     //uprintf("%f %f",target_theta,length);
 264:Src/foc.c     ****     SVPWM(target_theta,length/8.0f);  //8V = 12V *2/3;
 265:Src/foc.c     **** }
 266:Src/foc.c     **** 
 267:Src/foc.c     **** 
 268:Src/foc.c     **** #define GET_CURRENT(x)     (GET_SHUNT_VOLTAGE(current_adc_offset[x],current_adc_value[x])/SHUNT_RES
 269:Src/foc.c     **** 
 270:Src/foc.c     **** const int Speed_Control_CNT_MAX = FOC_FREQ/SPEED_FREQ;
 271:Src/foc.c     **** const int Position_Control_CNT_MAX = FOC_FREQ/POSITION_FREQ;
 272:Src/foc.c     **** 
 273:Src/foc.c     **** void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc){
 274:Src/foc.c     ****     float temp_iq,temp_id;
 275:Src/foc.c     ****     float temp_current,temp_current1;
 276:Src/foc.c     ****     static int current_control_cnt=0;
 277:Src/foc.c     **** 
 278:Src/foc.c     ****     if(hadc->Instance==CURRENT_ADC){
 279:Src/foc.c     ****         Check_Mode();
 280:Src/foc.c     ****         if(current_control_cnt%Position_Control_CNT_MAX==0){
 281:Src/foc.c     ****            if(Board_Mode == POSITION){
 282:Src/foc.c     ****                 Position_Control();
 283:Src/foc.c     ****             }
 284:Src/foc.c     ****         }
 285:Src/foc.c     ****         if(current_control_cnt%Speed_Control_CNT_MAX==0){
 286:Src/foc.c     ****             if(Board_Mode >= SPEED){
 287:Src/foc.c     ****                 Speed_Control();
 288:Src/foc.c     ****             }
 289:Src/foc.c     ****         }
 290:Src/foc.c     ****         current_control_cnt++;
 291:Src/foc.c     ****         if(current_control_cnt==FOC_FREQ/2/2){
 292:Src/foc.c     ****             current_control_cnt=0;
 293:Src/foc.c     ****         }
 294:Src/foc.c     ****         HAL_GPIO_WritePin(GPIOC,LED_GREEN_Pin,GPIO_PIN_SET);   
 295:Src/foc.c     **** 
 296:Src/foc.c     ****         UTILS_LP_FAST(current[0],GET_CURRENT(0),0.1);
 297:Src/foc.c     ****         UTILS_LP_FAST(current[1],GET_CURRENT(1),0.1);
 298:Src/foc.c     **** 
 299:Src/foc.c     ****         input_voltage = ADCVAL_TO_VOLTAGE(current_adc_value[2])*(VOLTAGE_RES1+VOLTAGE_RES2)/VOLTAGE
 300:Src/foc.c     **** 
 301:Src/foc.c     ****         Clark_Conv(current[1],current[0],&ialpha,&ibeta);
 302:Src/foc.c     ****     
 303:Src/foc.c     ****         Position = Get_Position();
 304:Src/foc.c     ****         Get_Speed();
 305:Src/foc.c     ****         Position_Degree = Position_to_Rad_Dgree(Position,1);
 306:Src/foc.c     ****         Position_Phase_Degree = Position_Degree * Motor.Pairs-Motor.Position_Phase_Offset;
 307:Src/foc.c     **** 
 308:Src/foc.c     ****         Park_Conv(ialpha,ibeta,Position_Phase_Degree,&temp_iq,&temp_id);
 309:Src/foc.c     ****         UTILS_LP_FAST(iq,temp_iq,0.1);
 310:Src/foc.c     ****         UTILS_LP_FAST(id,temp_id,0.1);
 311:Src/foc.c     ****         HAL_GPIO_WritePin(GPIOC,LED_GREEN_Pin,GPIO_PIN_RESET);   
 312:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 7


 313:Src/foc.c     **** #ifdef CAMERA_SUPPORT
 314:Src/foc.c     ****         Camera_Exposure(1,0.25,Camera_Catch_Angle);
 315:Src/foc.c     **** #endif
 316:Src/foc.c     **** 
 317:Src/foc.c     ****         if(FOC_Flag){
 318:Src/foc.c     ****             if(Board_Mode>=CURRENT){
 319:Src/foc.c     ****                 Current_Control();
 320:Src/foc.c     ****             }else if(Board_Mode == DUTY){
 321:Src/foc.c     ****                 float duty = Base_Duty + Duty_Amp * arm_cos_f32((Position_Degree-Position_Offset-Ph
 322:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 323:Src/foc.c     ****                 SVPWM(Position_Phase_Degree+90,duty);
 324:Src/foc.c     ****             }
 325:Src/foc.c     ****         }else{
 326:Src/foc.c     ****             if(Board_Mode!=TEST)
 327:Src/foc.c     ****                 FOC_STOP();
 328:Src/foc.c     ****         }
 329:Src/foc.c     ****         send_debug_wave(&wg1);
 330:Src/foc.c     ****         send_debug_wave(&wg2);
 331:Src/foc.c     **** 
 332:Src/foc.c     ****         //if(Wave_Flag)
 333:Src/foc.c     ****         //    send_wave(Position_Degree,Position_Phase_Degree,Speed,iq);
 334:Src/foc.c     **** /*
 335:Src/foc.c     ****         if(FOC_Flag){
 336:Src/foc.c     ****             
 337:Src/foc.c     ****             //
 338:Src/foc.c     ****             //send_wave(current[0],current[1],id,iq);
 339:Src/foc.c     ****         }else{
 340:Src/foc.c     ****             Set_Vector(U0,0.1f); 
 341:Src/foc.c     ****         }
 342:Src/foc.c     ****         */
 343:Src/foc.c     ****     }
 344:Src/foc.c     **** }
 345:Src/foc.c     **** 
 346:Src/foc.c     **** void Test_Direction(){
 347:Src/foc.c     ****     uint16_t last_pos=Position;
 348:Src/foc.c     ****     Mode old_mode;
 349:Src/foc.c     ****     int result=0;
 350:Src/foc.c     **** 
 351:Src/foc.c     ****     old_mode = Board_Mode;
 352:Src/foc.c     ****     Board_Mode = TEST;
 353:Src/foc.c     ****     for(int i=0;i<1000;++i){
 354:Src/foc.c     ****         SVPWM(i%360,0.1);
 355:Src/foc.c     ****         /*
 356:Src/foc.c     ****         for (int j=0;j<1000;++j){
 357:Src/foc.c     ****             __NOP();
 358:Src/foc.c     ****         }*/
 359:Src/foc.c     ****         HAL_Delay(1);
 360:Src/foc.c     ****         if(Position>last_pos){
 361:Src/foc.c     ****             result++;
 362:Src/foc.c     ****         }else if(Position<last_pos){
 363:Src/foc.c     ****             result--;
 364:Src/foc.c     ****         }
 365:Src/foc.c     ****         last_pos=Position;
 366:Src/foc.c     ****     }
 367:Src/foc.c     ****     FOC_STOP();
 368:Src/foc.c     ****     uprintf_polling("the test result is :%d \r\n",result);
 369:Src/foc.c     ****     if(result<0){
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 8


 370:Src/foc.c     ****         Motor.Encoder_Direction=!Motor.Encoder_Direction;
 371:Src/foc.c     ****     }
 372:Src/foc.c     **** 
 373:Src/foc.c     ****     Board_Mode = old_mode;
 374:Src/foc.c     **** }
 375:Src/foc.c     **** 
 376:Src/foc.c     **** void Measure_Res(){
 377:Src/foc.c     ****     Mode old_mode;
 378:Src/foc.c     ****     old_mode = Board_Mode;
 379:Src/foc.c     ****     Board_Mode = TEST; 
 380:Src/foc.c     **** 
 381:Src/foc.c     ****     Set_Vector(U4,0.1f);
 382:Src/foc.c     **** }
 383:Src/foc.c     **** 
 384:Src/foc.c     **** inline void Rotate_Phase(float start,float stop,float step){
 385:Src/foc.c     ****     for(float phase = start;phase<stop;phase+=step){
 386:Src/foc.c     ****         SVPWM(phase,0.1f);
 387:Src/foc.c     ****         HAL_Delay(1);
 388:Src/foc.c     ****     }
 389:Src/foc.c     **** }
 390:Src/foc.c     **** 
 391:Src/foc.c     **** void Detect_Encoder(){ 
 392:Src/foc.c     ****     // Ê£ÄÊµãÁ£ÅÁºñÁ†ÅÂô®ÈùôÊÄÅËØØÂ∑Æ
 393:Src/foc.c     ****     // Ê£ÄÊµãÁîµËßíÂ∫¶‰∏éÊú∫Ê¢∞ËßíÂ∫¶ÁöÑÂÅèÁßª
 394:Src/foc.c     ****     float sin_sum,cos_sum;
 395:Src/foc.c     ****     float last_position=0;
 396:Src/foc.c     ****     float m_sub = 0; // Êú∫Ê¢∞ËßíÂ∫¶ËΩ¨Ëøá‰∫ÜÂ§öÂ∞ë
 397:Src/foc.c     ****     Mode old_mode;
 398:Src/foc.c     **** 
 399:Src/foc.c     ****     old_mode = Board_Mode;
 400:Src/foc.c     ****     Board_Mode = TEST;
 401:Src/foc.c     **** 
 402:Src/foc.c     ****     sin_sum=cos_sum=0;
 403:Src/foc.c     ****     Motor.Position_Phase_Offset = 0;
 404:Src/foc.c     ****     for(int i =0; i<1000;++i){
 405:Src/foc.c     ****         HAL_Delay(1);
 406:Src/foc.c     ****         uprintf_polling("pos:%d\r\n",Position);
 407:Src/foc.c     ****     }
 408:Src/foc.c     ****     Rotate_Phase(0,360,360.0f/1000);
 409:Src/foc.c     ****     Set_Vector(U0,0.1);
 410:Src/foc.c     ****     HAL_Delay(10);
 411:Src/foc.c     ****     uprintf_polling("rotate to syn,and the phase pos_degree is %f\r\n",Position_Phase_Degree);
 412:Src/foc.c     ****     last_position = Position_Degree;
 413:Src/foc.c     ****     for(int i=0;i<21;++i){  // 3‰∏™‰∏ÄÂúàÁîµËßíÂ∫¶Ôºå21‰∏™‰∏ÄÂúàÊú∫Ê¢∞ËßíÂ∫¶
 414:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 415:Src/foc.c     ****         float sin,cos;
 416:Src/foc.c     ****         float off_temp = Position_Phase_Degree - (i+1)*120;
 417:Src/foc.c     ****         arm_sin_cos_f32(off_temp,&sin,&cos);
 418:Src/foc.c     ****         sin_sum+=sin;
 419:Src/foc.c     ****         cos_sum+=cos;
 420:Src/foc.c     ****         uprintf_polling("the sub is %f  sin is %f,cos is %f\r\n",off_temp,sin,cos);
 421:Src/foc.c     **** 
 422:Src/foc.c     ****         float tmp=(Position_Degree-last_position);
 423:Src/foc.c     ****         if(tmp<0){
 424:Src/foc.c     ****             tmp+=360;
 425:Src/foc.c     ****         }
 426:Src/foc.c     ****         m_sub+=tmp;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 9


 427:Src/foc.c     ****         last_position =  Position_Degree;
 428:Src/foc.c     ****     }
 429:Src/foc.c     ****     Set_Vector(U0,0.1);
 430:Src/foc.c     ****     Motor.Position_Phase_Offset=atan2f(sin_sum,cos_sum)*180/3.1415926f;
 431:Src/foc.c     ****     uprintf_polling("the offset is %f \r\n",Motor.Position_Phase_Offset);
 432:Src/foc.c     ****     uprintf_polling("the paris %f\r\n",120.0f*21/m_sub);
 433:Src/foc.c     **** 
 434:Src/foc.c     ****     Board_Mode = old_mode;
 435:Src/foc.c     **** }
 436:Src/foc.c     **** 
 437:Src/foc.c     **** 
 438:Src/foc.c     **** void Openloop_Runing(float duty, float freq, int8_t direction, float rps)
 439:Src/foc.c     **** {
 440:Src/foc.c     ****     static float theta = 0;
 441:Src/foc.c     ****     float delta_p = rps * Motor.Pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 442:Src/foc.c     **** 
 443:Src/foc.c     ****     theta += direction * delta_p;
 444:Src/foc.c     ****     if (theta > 360)
 445:Src/foc.c     ****     {
 446:Src/foc.c     ****         theta -= 360;
 447:Src/foc.c     ****     }
 448:Src/foc.c     ****     else if (theta < 0)
 449:Src/foc.c     ****     {
 450:Src/foc.c     ****         theta += 360;
 451:Src/foc.c     ****     }
 452:Src/foc.c     ****     //SVPWM(theta, duty);
 453:Src/foc.c     **** }
 454:Src/foc.c     **** 
 455:Src/foc.c     **** static void Get_Speed(){
  32              		.loc 1 455 24 view -0
  33              		.cfi_startproc
  34              		@ args = 0, pretend = 0, frame = 0
  35              		@ frame_needed = 0, uses_anonymous_args = 0
  36 0000 70B5     		push	{r4, r5, r6, lr}
  37              	.LCFI0:
  38              		.cfi_def_cfa_offset 16
  39              		.cfi_offset 4, -16
  40              		.cfi_offset 5, -12
  41              		.cfi_offset 6, -8
  42              		.cfi_offset 14, -4
  43 0002 2DED028B 		vpush.64	{d8}
  44              	.LCFI1:
  45              		.cfi_def_cfa_offset 24
  46              		.cfi_offset 80, -24
  47              		.cfi_offset 81, -20
 456:Src/foc.c     ****     static float last_position_phase;
  48              		.loc 1 456 5 view .LVU1
 457:Src/foc.c     ****     float sub=0;
  49              		.loc 1 457 5 view .LVU2
  50              	.LVL0:
 458:Src/foc.c     ****     sub= Position_Degree - last_position_phase;
  51              		.loc 1 458 5 view .LVU3
  52              		.loc 1 458 26 is_stmt 0 view .LVU4
  53 0006 244B     		ldr	r3, .L10+8
  54 0008 93ED008A 		vldr.32	s16, [r3]
  55 000c 234B     		ldr	r3, .L10+12
  56 000e D3ED007A 		vldr.32	s15, [r3]
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 10


  57              		.loc 1 458 8 view .LVU5
  58 0012 78EE677A 		vsub.f32	s15, s16, s15
  59              	.LVL1:
 459:Src/foc.c     ****     if(sub<-180){
  60              		.loc 1 459 5 is_stmt 1 view .LVU6
  61              		.loc 1 459 7 is_stmt 0 view .LVU7
  62 0016 9FED227A 		vldr.32	s14, .L10+16
  63 001a F4EEC77A 		vcmpe.f32	s15, s14
  64 001e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
  65 0022 28D5     		bpl	.L8
 460:Src/foc.c     ****         sub+=360;
  66              		.loc 1 460 9 is_stmt 1 view .LVU8
  67              		.loc 1 460 12 is_stmt 0 view .LVU9
  68 0024 9FED1F7A 		vldr.32	s14, .L10+20
  69 0028 77EE877A 		vadd.f32	s15, s15, s14
  70              	.LVL2:
  71              	.L4:
 461:Src/foc.c     ****     }else if(sub>180){
 462:Src/foc.c     ****         sub-=360;
 463:Src/foc.c     ****     }
 464:Src/foc.c     ****     UTILS_LP_FAST(Speed,sub*SPEED_FREQ,0.4);
  72              		.loc 1 464 5 is_stmt 1 view .LVU10
  73 002c 1E4E     		ldr	r6, .L10+24
  74 002e D6ED008A 		vldr.32	s17, [r6]
  75 0032 9FED1E7A 		vldr.32	s14, .L10+28
  76 0036 67EE877A 		vmul.f32	s15, s15, s14
  77              	.LVL3:
  78              		.loc 1 464 5 is_stmt 0 view .LVU11
  79 003a 78EEE77A 		vsub.f32	s15, s17, s15
  80 003e 17EE900A 		vmov	r0, s15
  81 0042 FFF7FEFF 		bl	__aeabi_f2d
  82              	.LVL4:
  83 0046 12A3     		adr	r3, .L10
  84 0048 D3E90023 		ldrd	r2, [r3]
  85 004c FFF7FEFF 		bl	__aeabi_dmul
  86              	.LVL5:
  87 0050 0446     		mov	r4, r0
  88 0052 0D46     		mov	r5, r1
  89 0054 18EE900A 		vmov	r0, s17
  90 0058 FFF7FEFF 		bl	__aeabi_f2d
  91              	.LVL6:
  92 005c 2246     		mov	r2, r4
  93 005e 2B46     		mov	r3, r5
  94 0060 FFF7FEFF 		bl	__aeabi_dsub
  95              	.LVL7:
  96 0064 FFF7FEFF 		bl	__aeabi_d2f
  97              	.LVL8:
  98 0068 3060     		str	r0, [r6]	@ float
 465:Src/foc.c     ****     last_position_phase = Position_Degree;
  99              		.loc 1 465 5 is_stmt 1 view .LVU12
 100              		.loc 1 465 25 is_stmt 0 view .LVU13
 101 006a 0C4B     		ldr	r3, .L10+12
 102 006c 83ED008A 		vstr.32	s16, [r3]
 466:Src/foc.c     **** }
 103              		.loc 1 466 1 view .LVU14
 104 0070 BDEC028B 		vldm	sp!, {d8}
 105              	.LCFI2:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 11


 106              		.cfi_remember_state
 107              		.cfi_restore 80
 108              		.cfi_restore 81
 109              		.cfi_def_cfa_offset 16
 110 0074 70BD     		pop	{r4, r5, r6, pc}
 111              	.LVL9:
 112              	.L8:
 113              	.LCFI3:
 114              		.cfi_restore_state
 461:Src/foc.c     ****     }else if(sub>180){
 115              		.loc 1 461 11 is_stmt 1 view .LVU15
 461:Src/foc.c     ****     }else if(sub>180){
 116              		.loc 1 461 13 is_stmt 0 view .LVU16
 117 0076 9FED0E7A 		vldr.32	s14, .L10+32
 118 007a F4EEC77A 		vcmpe.f32	s15, s14
 119 007e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 120 0082 D3DD     		ble	.L4
 462:Src/foc.c     ****     }
 121              		.loc 1 462 9 is_stmt 1 view .LVU17
 462:Src/foc.c     ****     }
 122              		.loc 1 462 12 is_stmt 0 view .LVU18
 123 0084 9FED077A 		vldr.32	s14, .L10+20
 124 0088 77EEC77A 		vsub.f32	s15, s15, s14
 125              	.LVL10:
 462:Src/foc.c     ****     }
 126              		.loc 1 462 12 view .LVU19
 127 008c CEE7     		b	.L4
 128              	.L11:
 129 008e 00BF     		.align	3
 130              	.L10:
 131 0090 9A999999 		.word	-1717986918
 132 0094 9999D93F 		.word	1071225241
 133 0098 00000000 		.word	Position_Degree
 134 009c 00000000 		.word	.LANCHOR0
 135 00a0 000034C3 		.word	-1020002304
 136 00a4 0000B443 		.word	1135869952
 137 00a8 00000000 		.word	Speed
 138 00ac 00007A45 		.word	1165623296
 139 00b0 00003443 		.word	1127481344
 140              		.cfi_endproc
 141              	.LFE179:
 143              		.section	.text.Position_Control,"ax",%progbits
 144              		.align	1
 145              		.syntax unified
 146              		.thumb
 147              		.thumb_func
 148              		.fpu fpv4-sp-d16
 150              	Position_Control:
 151              	.LFB181:
 467:Src/foc.c     **** static void Speed_Control(){
 468:Src/foc.c     **** 
 469:Src/foc.c     ****     //Get_Speed();
 470:Src/foc.c     ****     Iq_Set=PID_Control(&Speed_PID,Speed_Set,Speed);
 471:Src/foc.c     ****     //last_position_phase = Position_Degree;
 472:Src/foc.c     **** 
 473:Src/foc.c     ****  
 474:Src/foc.c     **** }
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 12


 475:Src/foc.c     **** 
 476:Src/foc.c     **** static void Position_Control(){
 152              		.loc 1 476 31 is_stmt 1 view -0
 153              		.cfi_startproc
 154              		@ args = 0, pretend = 0, frame = 0
 155              		@ frame_needed = 0, uses_anonymous_args = 0
 156              		@ link register save eliminated.
 477:Src/foc.c     ****     float err = Position_Degree_Set - Position_Degree;
 157              		.loc 1 477 5 view .LVU21
 158              		.loc 1 477 37 is_stmt 0 view .LVU22
 159 0000 254B     		ldr	r3, .L23
 160 0002 D3ED007A 		vldr.32	s15, [r3]
 161 0006 254B     		ldr	r3, .L23+4
 162 0008 93ED007A 		vldr.32	s14, [r3]
 163              		.loc 1 477 11 view .LVU23
 164 000c 77EEC77A 		vsub.f32	s15, s15, s14
 165              	.LVL11:
 478:Src/foc.c     ****     float out = 0;
 166              		.loc 1 478 5 is_stmt 1 view .LVU24
 479:Src/foc.c     ****     if(err>180){
 167              		.loc 1 479 5 view .LVU25
 168              		.loc 1 479 7 is_stmt 0 view .LVU26
 169 0010 9FED237A 		vldr.32	s14, .L23+8
 170 0014 F4EEC77A 		vcmpe.f32	s15, s14
 171 0018 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 172 001c 30DD     		ble	.L22
 480:Src/foc.c     ****         err-=360;         //target = 359,now=0;
 173              		.loc 1 480 9 is_stmt 1 view .LVU27
 174              		.loc 1 480 12 is_stmt 0 view .LVU28
 175 001e 9FED217A 		vldr.32	s14, .L23+12
 176 0022 77EEC77A 		vsub.f32	s15, s15, s14
 177              	.LVL12:
 178              	.L15:
 481:Src/foc.c     ****     }else if(err<-180){
 482:Src/foc.c     ****         err+=360;        // target=0,now=359
 483:Src/foc.c     ****     }
 484:Src/foc.c     ****     if(fabsf(err)<Position_PID.I_ERR_LIMIT){
 179              		.loc 1 484 5 is_stmt 1 view .LVU29
 180              		.loc 1 484 8 is_stmt 0 view .LVU30
 181 0026 B0EEE77A 		vabs.f32	s14, s15
 182              		.loc 1 484 31 view .LVU31
 183 002a 1F4B     		ldr	r3, .L23+16
 184 002c D3ED086A 		vldr.32	s13, [r3, #32]
 185              		.loc 1 484 7 view .LVU32
 186 0030 B4EEE67A 		vcmpe.f32	s14, s13
 187 0034 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 188 0038 05D5     		bpl	.L17
 485:Src/foc.c     ****         Position_PID.i+=err;
 189              		.loc 1 485 9 is_stmt 1 view .LVU33
 190              		.loc 1 485 23 is_stmt 0 view .LVU34
 191 003a 93ED037A 		vldr.32	s14, [r3, #12]
 192 003e 37EE277A 		vadd.f32	s14, s14, s15
 193 0042 83ED037A 		vstr.32	s14, [r3, #12]
 194              	.L17:
 486:Src/foc.c     ****     }
 487:Src/foc.c     ****     out = Position_PID.KP * err + Position_PID.KD *(err-Position_PID.last_err) + Position_PID.i * P
 195              		.loc 1 487 5 is_stmt 1 view .LVU35
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 13


 196              		.loc 1 487 23 is_stmt 0 view .LVU36
 197 0046 184B     		ldr	r3, .L23+16
 198 0048 93ED007A 		vldr.32	s14, [r3]
 199              		.loc 1 487 27 view .LVU37
 200 004c 27EE277A 		vmul.f32	s14, s14, s15
 201              		.loc 1 487 47 view .LVU38
 202 0050 D3ED016A 		vldr.32	s13, [r3, #4]
 203              		.loc 1 487 69 view .LVU39
 204 0054 93ED046A 		vldr.32	s12, [r3, #16]
 205              		.loc 1 487 56 view .LVU40
 206 0058 37EEC66A 		vsub.f32	s12, s15, s12
 207              		.loc 1 487 51 view .LVU41
 208 005c 66EE866A 		vmul.f32	s13, s13, s12
 209              		.loc 1 487 33 view .LVU42
 210 0060 37EE267A 		vadd.f32	s14, s14, s13
 211              		.loc 1 487 94 view .LVU43
 212 0064 D3ED036A 		vldr.32	s13, [r3, #12]
 213              		.loc 1 487 111 view .LVU44
 214 0068 93ED026A 		vldr.32	s12, [r3, #8]
 215              		.loc 1 487 97 view .LVU45
 216 006c 66EE866A 		vmul.f32	s13, s13, s12
 217              		.loc 1 487 9 view .LVU46
 218 0070 37EE267A 		vadd.f32	s14, s14, s13
 219              	.LVL13:
 488:Src/foc.c     ****     Position_PID.last_err = err;
 220              		.loc 1 488 5 is_stmt 1 view .LVU47
 221              		.loc 1 488 27 is_stmt 0 view .LVU48
 222 0074 C3ED047A 		vstr.32	s15, [r3, #16]
 489:Src/foc.c     **** 
 490:Src/foc.c     ****     Speed_Set = out;
 223              		.loc 1 490 5 is_stmt 1 view .LVU49
 224              		.loc 1 490 15 is_stmt 0 view .LVU50
 225 0078 0C4B     		ldr	r3, .L23+20
 226 007a 83ED007A 		vstr.32	s14, [r3]
 491:Src/foc.c     **** 
 492:Src/foc.c     **** }
 227              		.loc 1 492 1 view .LVU51
 228 007e 7047     		bx	lr
 229              	.LVL14:
 230              	.L22:
 481:Src/foc.c     ****         err+=360;        // target=0,now=359
 231              		.loc 1 481 11 is_stmt 1 view .LVU52
 481:Src/foc.c     ****         err+=360;        // target=0,now=359
 232              		.loc 1 481 13 is_stmt 0 view .LVU53
 233 0080 9FED0B7A 		vldr.32	s14, .L23+24
 234 0084 F4EEC77A 		vcmpe.f32	s15, s14
 235 0088 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 236 008c CBD5     		bpl	.L15
 482:Src/foc.c     ****     }
 237              		.loc 1 482 9 is_stmt 1 view .LVU54
 482:Src/foc.c     ****     }
 238              		.loc 1 482 12 is_stmt 0 view .LVU55
 239 008e 9FED057A 		vldr.32	s14, .L23+12
 240 0092 77EE877A 		vadd.f32	s15, s15, s14
 241              	.LVL15:
 482:Src/foc.c     ****     }
 242              		.loc 1 482 12 view .LVU56
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 14


 243 0096 C6E7     		b	.L15
 244              	.L24:
 245              		.align	2
 246              	.L23:
 247 0098 00000000 		.word	Position_Degree_Set
 248 009c 00000000 		.word	Position_Degree
 249 00a0 00003443 		.word	1127481344
 250 00a4 0000B443 		.word	1135869952
 251 00a8 00000000 		.word	.LANCHOR1
 252 00ac 00000000 		.word	.LANCHOR2
 253 00b0 000034C3 		.word	-1020002304
 254              		.cfi_endproc
 255              	.LFE181:
 257              		.section	.text.Speed_Control,"ax",%progbits
 258              		.align	1
 259              		.syntax unified
 260              		.thumb
 261              		.thumb_func
 262              		.fpu fpv4-sp-d16
 264              	Speed_Control:
 265              	.LFB180:
 467:Src/foc.c     **** 
 266              		.loc 1 467 28 is_stmt 1 view -0
 267              		.cfi_startproc
 268              		@ args = 0, pretend = 0, frame = 0
 269              		@ frame_needed = 0, uses_anonymous_args = 0
 270 0000 08B5     		push	{r3, lr}
 271              	.LCFI4:
 272              		.cfi_def_cfa_offset 8
 273              		.cfi_offset 3, -8
 274              		.cfi_offset 14, -4
 470:Src/foc.c     ****     //last_position_phase = Position_Degree;
 275              		.loc 1 470 5 view .LVU58
 470:Src/foc.c     ****     //last_position_phase = Position_Degree;
 276              		.loc 1 470 12 is_stmt 0 view .LVU59
 277 0002 064B     		ldr	r3, .L27
 278 0004 D3ED000A 		vldr.32	s1, [r3]
 279 0008 054B     		ldr	r3, .L27+4
 280 000a 93ED000A 		vldr.32	s0, [r3]
 281 000e 0548     		ldr	r0, .L27+8
 282 0010 FFF7FEFF 		bl	PID_Control
 283              	.LVL16:
 470:Src/foc.c     ****     //last_position_phase = Position_Degree;
 284              		.loc 1 470 11 view .LVU60
 285 0014 044B     		ldr	r3, .L27+12
 286 0016 83ED000A 		vstr.32	s0, [r3]
 474:Src/foc.c     **** 
 287              		.loc 1 474 1 view .LVU61
 288 001a 08BD     		pop	{r3, pc}
 289              	.L28:
 290              		.align	2
 291              	.L27:
 292 001c 00000000 		.word	Speed
 293 0020 00000000 		.word	.LANCHOR2
 294 0024 00000000 		.word	.LANCHOR3
 295 0028 00000000 		.word	.LANCHOR4
 296              		.cfi_endproc
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 15


 297              	.LFE180:
 299              		.section	.text.PID_I_Clear,"ax",%progbits
 300              		.align	1
 301              		.global	PID_I_Clear
 302              		.syntax unified
 303              		.thumb
 304              		.thumb_func
 305              		.fpu fpv4-sp-d16
 307              	PID_I_Clear:
 308              	.LFB166:
 117:Src/foc.c     ****     Iq_PID.i=0;
 309              		.loc 1 117 19 is_stmt 1 view -0
 310              		.cfi_startproc
 311              		@ args = 0, pretend = 0, frame = 0
 312              		@ frame_needed = 0, uses_anonymous_args = 0
 313              		@ link register save eliminated.
 118:Src/foc.c     ****     Id_PID.i=0;
 314              		.loc 1 118 5 view .LVU63
 118:Src/foc.c     ****     Id_PID.i=0;
 315              		.loc 1 118 13 is_stmt 0 view .LVU64
 316 0000 0023     		movs	r3, #0
 317 0002 044A     		ldr	r2, .L30
 318 0004 D360     		str	r3, [r2, #12]	@ float
 119:Src/foc.c     ****     Speed_PID.i=0;
 319              		.loc 1 119 5 is_stmt 1 view .LVU65
 119:Src/foc.c     ****     Speed_PID.i=0;
 320              		.loc 1 119 13 is_stmt 0 view .LVU66
 321 0006 044A     		ldr	r2, .L30+4
 322 0008 D360     		str	r3, [r2, #12]	@ float
 120:Src/foc.c     ****     Position_PID.i=0;
 323              		.loc 1 120 5 is_stmt 1 view .LVU67
 120:Src/foc.c     ****     Position_PID.i=0;
 324              		.loc 1 120 16 is_stmt 0 view .LVU68
 325 000a 044A     		ldr	r2, .L30+8
 326 000c D360     		str	r3, [r2, #12]	@ float
 121:Src/foc.c     **** }
 327              		.loc 1 121 5 is_stmt 1 view .LVU69
 121:Src/foc.c     **** }
 328              		.loc 1 121 19 is_stmt 0 view .LVU70
 329 000e 044A     		ldr	r2, .L30+12
 330 0010 D360     		str	r3, [r2, #12]	@ float
 122:Src/foc.c     **** 
 331              		.loc 1 122 1 view .LVU71
 332 0012 7047     		bx	lr
 333              	.L31:
 334              		.align	2
 335              	.L30:
 336 0014 00000000 		.word	.LANCHOR5
 337 0018 00000000 		.word	.LANCHOR6
 338 001c 00000000 		.word	.LANCHOR3
 339 0020 00000000 		.word	.LANCHOR1
 340              		.cfi_endproc
 341              	.LFE166:
 343              		.section	.rodata.Current_ADC_Init.str1.4,"aMS",%progbits,1
 344              		.align	2
 345              	.LC0:
 346 0000 74686520 		.ascii	"the offset of curr_adc is %d,%d\015\012\000"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 16


 346      6F666673 
 346      6574206F 
 346      66206375 
 346      72725F61 
 347              		.section	.text.Current_ADC_Init,"ax",%progbits
 348              		.align	1
 349              		.global	Current_ADC_Init
 350              		.syntax unified
 351              		.thumb
 352              		.thumb_func
 353              		.fpu fpv4-sp-d16
 355              	Current_ADC_Init:
 356              	.LVL17:
 357              	.LFB167:
 160:Src/foc.c     ****     int32_t curr_sum[2]={0};
 358              		.loc 1 160 33 is_stmt 1 view -0
 359              		.cfi_startproc
 360              		@ args = 0, pretend = 0, frame = 8
 361              		@ frame_needed = 0, uses_anonymous_args = 0
 160:Src/foc.c     ****     int32_t curr_sum[2]={0};
 362              		.loc 1 160 33 is_stmt 0 view .LVU73
 363 0000 30B5     		push	{r4, r5, lr}
 364              	.LCFI5:
 365              		.cfi_def_cfa_offset 12
 366              		.cfi_offset 4, -12
 367              		.cfi_offset 5, -8
 368              		.cfi_offset 14, -4
 369 0002 83B0     		sub	sp, sp, #12
 370              	.LCFI6:
 371              		.cfi_def_cfa_offset 24
 372 0004 0546     		mov	r5, r0
 161:Src/foc.c     ****     #ifdef DRV8302
 373              		.loc 1 161 5 is_stmt 1 view .LVU74
 161:Src/foc.c     ****     #ifdef DRV8302
 374              		.loc 1 161 13 is_stmt 0 view .LVU75
 375 0006 0024     		movs	r4, #0
 376 0008 0094     		str	r4, [sp]
 377 000a 0194     		str	r4, [sp, #4]
 165:Src/foc.c     ****     for(int i=0;i<times;++i){
 378              		.loc 1 165 5 is_stmt 1 view .LVU76
 379 000c 0A20     		movs	r0, #10
 380              	.LVL18:
 165:Src/foc.c     ****     for(int i=0;i<times;++i){
 381              		.loc 1 165 5 is_stmt 0 view .LVU77
 382 000e FFF7FEFF 		bl	HAL_Delay
 383              	.LVL19:
 166:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 384              		.loc 1 166 5 is_stmt 1 view .LVU78
 385              	.LBB14:
 166:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 386              		.loc 1 166 9 view .LVU79
 387              	.L33:
 166:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 388              		.loc 1 166 17 discriminator 1 view .LVU80
 166:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 389              		.loc 1 166 5 is_stmt 0 discriminator 1 view .LVU81
 390 0012 AC42     		cmp	r4, r5
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 17


 391 0014 0FDA     		bge	.L36
 167:Src/foc.c     ****         curr_sum[1]+=current_adc_value[1];
 392              		.loc 1 167 9 is_stmt 1 discriminator 3 view .LVU82
 167:Src/foc.c     ****         curr_sum[1]+=current_adc_value[1];
 393              		.loc 1 167 39 is_stmt 0 discriminator 3 view .LVU83
 394 0016 104A     		ldr	r2, .L37
 395 0018 B2F90010 		ldrsh	r1, [r2]
 167:Src/foc.c     ****         curr_sum[1]+=current_adc_value[1];
 396              		.loc 1 167 20 discriminator 3 view .LVU84
 397 001c 009B     		ldr	r3, [sp]
 398 001e 0B44     		add	r3, r3, r1
 399 0020 0093     		str	r3, [sp]
 168:Src/foc.c     ****         HAL_Delay(1);
 400              		.loc 1 168 9 is_stmt 1 discriminator 3 view .LVU85
 168:Src/foc.c     ****         HAL_Delay(1);
 401              		.loc 1 168 39 is_stmt 0 discriminator 3 view .LVU86
 402 0022 B2F90220 		ldrsh	r2, [r2, #2]
 168:Src/foc.c     ****         HAL_Delay(1);
 403              		.loc 1 168 20 discriminator 3 view .LVU87
 404 0026 019B     		ldr	r3, [sp, #4]
 405 0028 1344     		add	r3, r3, r2
 406 002a 0193     		str	r3, [sp, #4]
 169:Src/foc.c     ****     }
 407              		.loc 1 169 9 is_stmt 1 discriminator 3 view .LVU88
 408 002c 0120     		movs	r0, #1
 409 002e FFF7FEFF 		bl	HAL_Delay
 410              	.LVL20:
 166:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 411              		.loc 1 166 25 discriminator 3 view .LVU89
 412 0032 0134     		adds	r4, r4, #1
 413              	.LVL21:
 166:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 414              		.loc 1 166 25 is_stmt 0 discriminator 3 view .LVU90
 415 0034 EDE7     		b	.L33
 416              	.L36:
 166:Src/foc.c     ****         curr_sum[0]+=current_adc_value[0];
 417              		.loc 1 166 25 discriminator 3 view .LVU91
 418              	.LBE14:
 172:Src/foc.c     ****     current_adc_offset[1]=curr_sum[1]/times;
 419              		.loc 1 172 5 is_stmt 1 view .LVU92
 172:Src/foc.c     ****     current_adc_offset[1]=curr_sum[1]/times;
 420              		.loc 1 172 35 is_stmt 0 view .LVU93
 421 0036 0099     		ldr	r1, [sp]
 172:Src/foc.c     ****     current_adc_offset[1]=curr_sum[1]/times;
 422              		.loc 1 172 38 view .LVU94
 423 0038 91FBF5F1 		sdiv	r1, r1, r5
 172:Src/foc.c     ****     current_adc_offset[1]=curr_sum[1]/times;
 424              		.loc 1 172 26 view .LVU95
 425 003c 09B2     		sxth	r1, r1
 426 003e 074B     		ldr	r3, .L37+4
 427 0040 1980     		strh	r1, [r3]	@ movhi
 173:Src/foc.c     **** 
 428              		.loc 1 173 5 is_stmt 1 view .LVU96
 173:Src/foc.c     **** 
 429              		.loc 1 173 35 is_stmt 0 view .LVU97
 430 0042 019A     		ldr	r2, [sp, #4]
 173:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 18


 431              		.loc 1 173 38 view .LVU98
 432 0044 92FBF5F2 		sdiv	r2, r2, r5
 173:Src/foc.c     **** 
 433              		.loc 1 173 26 view .LVU99
 434 0048 12B2     		sxth	r2, r2
 435 004a 5A80     		strh	r2, [r3, #2]	@ movhi
 178:Src/foc.c     **** 
 436              		.loc 1 178 4 is_stmt 1 view .LVU100
 437 004c 0448     		ldr	r0, .L37+8
 438 004e FFF7FEFF 		bl	uprintf_polling
 439              	.LVL22:
 180:Src/foc.c     **** 
 440              		.loc 1 180 1 is_stmt 0 view .LVU101
 441 0052 03B0     		add	sp, sp, #12
 442              	.LCFI7:
 443              		.cfi_def_cfa_offset 12
 444              		@ sp needed
 445 0054 30BD     		pop	{r4, r5, pc}
 446              	.LVL23:
 447              	.L38:
 180:Src/foc.c     **** 
 448              		.loc 1 180 1 view .LVU102
 449 0056 00BF     		.align	2
 450              	.L37:
 451 0058 00000000 		.word	.LANCHOR7
 452 005c 00000000 		.word	.LANCHOR8
 453 0060 00000000 		.word	.LC0
 454              		.cfi_endproc
 455              	.LFE167:
 457              		.section	.text.Foc_Init,"ax",%progbits
 458              		.align	1
 459              		.global	Foc_Init
 460              		.syntax unified
 461              		.thumb
 462              		.thumb_func
 463              		.fpu fpv4-sp-d16
 465              	Foc_Init:
 466              	.LFB168:
 182:Src/foc.c     ****   AS5047_Set_Direction(Motor.Encoder_Direction);
 467              		.loc 1 182 16 is_stmt 1 view -0
 468              		.cfi_startproc
 469              		@ args = 0, pretend = 0, frame = 0
 470              		@ frame_needed = 0, uses_anonymous_args = 0
 471 0000 10B5     		push	{r4, lr}
 472              	.LCFI8:
 473              		.cfi_def_cfa_offset 8
 474              		.cfi_offset 4, -8
 475              		.cfi_offset 14, -4
 183:Src/foc.c     ****   HAL_ADC_Start_DMA(&hadc1,current_adc_value,3);
 476              		.loc 1 183 3 view .LVU104
 477 0002 1E4B     		ldr	r3, .L41
 478 0004 187A     		ldrb	r0, [r3, #8]	@ zero_extendqisi2
 479 0006 FFF7FEFF 		bl	AS5047_Set_Direction
 480              	.LVL24:
 184:Src/foc.c     **** 
 481              		.loc 1 184 3 view .LVU105
 482 000a 0322     		movs	r2, #3
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 19


 483 000c 1C49     		ldr	r1, .L41+4
 484 000e 1D48     		ldr	r0, .L41+8
 485 0010 FFF7FEFF 		bl	HAL_ADC_Start_DMA
 486              	.LVL25:
 186:Src/foc.c     **** 
 487              		.loc 1 186 3 view .LVU106
 488 0014 1C48     		ldr	r0, .L41+12
 489 0016 FFF7FEFF 		bl	HAL_TIM_Base_Start
 490              	.LVL26:
 189:Src/foc.c     ****   HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_2);
 491              		.loc 1 189 3 view .LVU107
 492 001a 1C4C     		ldr	r4, .L41+16
 493 001c 0021     		movs	r1, #0
 494 001e 2046     		mov	r0, r4
 495 0020 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 496              	.LVL27:
 190:Src/foc.c     ****   HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_3);
 497              		.loc 1 190 3 view .LVU108
 498 0024 0421     		movs	r1, #4
 499 0026 2046     		mov	r0, r4
 500 0028 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 501              	.LVL28:
 191:Src/foc.c     **** 
 502              		.loc 1 191 3 view .LVU109
 503 002c 0821     		movs	r1, #8
 504 002e 2046     		mov	r0, r4
 505 0030 FFF7FEFF 		bl	HAL_TIM_PWM_Start
 506              	.LVL29:
 193:Src/foc.c     ****   HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_2);
 507              		.loc 1 193 3 view .LVU110
 508 0034 0021     		movs	r1, #0
 509 0036 2046     		mov	r0, r4
 510 0038 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 511              	.LVL30:
 194:Src/foc.c     ****   HAL_TIMEx_PWMN_Start(&htim1, TIM_CHANNEL_3);
 512              		.loc 1 194 3 view .LVU111
 513 003c 0421     		movs	r1, #4
 514 003e 2046     		mov	r0, r4
 515 0040 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 516              	.LVL31:
 195:Src/foc.c     **** 
 517              		.loc 1 195 3 view .LVU112
 518 0044 0821     		movs	r1, #8
 519 0046 2046     		mov	r0, r4
 520 0048 FFF7FEFF 		bl	HAL_TIMEx_PWMN_Start
 521              	.LVL32:
 200:Src/foc.c     **** 
 522              		.loc 1 200 3 view .LVU113
 523 004c 1420     		movs	r0, #20
 524 004e FFF7FEFF 		bl	Current_ADC_Init
 525              	.LVL33:
 202:Src/foc.c     ****   HAL_NVIC_EnableIRQ(DMA2_Stream0_IRQn);
 526              		.loc 1 202 3 view .LVU114
 527 0052 0022     		movs	r2, #0
 528 0054 1146     		mov	r1, r2
 529 0056 3820     		movs	r0, #56
 530 0058 FFF7FEFF 		bl	HAL_NVIC_SetPriority
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 20


 531              	.LVL34:
 203:Src/foc.c     ****   /* DMA2_Stream2_IRQn interrupt configuration */
 532              		.loc 1 203 3 view .LVU115
 533 005c 3820     		movs	r0, #56
 534 005e FFF7FEFF 		bl	HAL_NVIC_EnableIRQ
 535              	.LVL35:
 205:Src/foc.c     ****   HAL_NVIC_EnableIRQ(DMA2_Stream2_IRQn);
 536              		.loc 1 205 3 view .LVU116
 537 0062 0022     		movs	r2, #0
 538 0064 1146     		mov	r1, r2
 539 0066 3A20     		movs	r0, #58
 540 0068 FFF7FEFF 		bl	HAL_NVIC_SetPriority
 541              	.LVL36:
 206:Src/foc.c     **** 
 542              		.loc 1 206 3 view .LVU117
 543 006c 3A20     		movs	r0, #58
 544 006e FFF7FEFF 		bl	HAL_NVIC_EnableIRQ
 545              	.LVL37:
 208:Src/foc.c     **** }
 546              		.loc 1 208 3 view .LVU118
 547 0072 0748     		ldr	r0, .L41+20
 548 0074 FFF7FEFF 		bl	HAL_TIM_Base_Start_IT
 549              	.LVL38:
 209:Src/foc.c     **** 
 550              		.loc 1 209 1 is_stmt 0 view .LVU119
 551 0078 10BD     		pop	{r4, pc}
 552              	.L42:
 553 007a 00BF     		.align	2
 554              	.L41:
 555 007c 00000000 		.word	.LANCHOR9
 556 0080 00000000 		.word	.LANCHOR7
 557 0084 00000000 		.word	hadc1
 558 0088 00000000 		.word	htim8
 559 008c 00000000 		.word	htim1
 560 0090 00000000 		.word	htim7
 561              		.cfi_endproc
 562              	.LFE168:
 564              		.section	.text.Clark_Conv,"ax",%progbits
 565              		.align	1
 566              		.global	Clark_Conv
 567              		.syntax unified
 568              		.thumb
 569              		.thumb_func
 570              		.fpu fpv4-sp-d16
 572              	Clark_Conv:
 573              	.LVL39:
 574              	.LFB169:
 214:Src/foc.c     ****     ia= -ia;
 575              		.loc 1 214 1 is_stmt 1 view -0
 576              		.cfi_startproc
 577              		@ args = 0, pretend = 0, frame = 0
 578              		@ frame_needed = 0, uses_anonymous_args = 0
 579              		@ link register save eliminated.
 215:Src/foc.c     ****     ic= -ic;
 580              		.loc 1 215 5 view .LVU121
 215:Src/foc.c     ****     ic= -ic;
 581              		.loc 1 215 7 is_stmt 0 view .LVU122
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 21


 582 0000 B1EE400A 		vneg.f32	s0, s0
 583              	.LVL40:
 216:Src/foc.c     ****     // ‰∏∫‰ªÄ‰πàËøôÈáåË¶ÅÂä†Ë¥üÂè∑Âë¢
 584              		.loc 1 216 5 is_stmt 1 view .LVU123
 221:Src/foc.c     ****     *ialpha = 1.5f*ia;
 585              		.loc 1 221 5 view .LVU124
 586 0004 70EE600A 		vsub.f32	s1, s0, s1
 587              	.LVL41:
 222:Src/foc.c     ****     *ibeta = SQRT3_2 * ib + SQRT3_2* (ib + ia);
 588              		.loc 1 222 5 view .LVU125
 222:Src/foc.c     ****     *ibeta = SQRT3_2 * ib + SQRT3_2* (ib + ia);
 589              		.loc 1 222 19 is_stmt 0 view .LVU126
 590 0008 F7EE087A 		vmov.f32	s15, #1.5e+0
 591 000c 60EE277A 		vmul.f32	s15, s0, s15
 222:Src/foc.c     ****     *ibeta = SQRT3_2 * ib + SQRT3_2* (ib + ia);
 592              		.loc 1 222 13 view .LVU127
 593 0010 C0ED007A 		vstr.32	s15, [r0]
 223:Src/foc.c     **** }
 594              		.loc 1 223 5 is_stmt 1 view .LVU128
 223:Src/foc.c     **** }
 595              		.loc 1 223 22 is_stmt 0 view .LVU129
 596 0014 9FED067A 		vldr.32	s14, .L44
 597 0018 60EEC77A 		vnmul.f32	s15, s1, s14
 223:Src/foc.c     **** }
 598              		.loc 1 223 36 view .LVU130
 599 001c 30EE600A 		vsub.f32	s0, s0, s1
 600              	.LVL42:
 223:Src/foc.c     **** }
 601              		.loc 1 223 36 view .LVU131
 602 0020 20EE070A 		vmul.f32	s0, s0, s14
 223:Src/foc.c     **** }
 603              		.loc 1 223 27 view .LVU132
 604 0024 37EE800A 		vadd.f32	s0, s15, s0
 223:Src/foc.c     **** }
 605              		.loc 1 223 12 view .LVU133
 606 0028 81ED000A 		vstr.32	s0, [r1]
 224:Src/foc.c     **** 
 607              		.loc 1 224 1 view .LVU134
 608 002c 7047     		bx	lr
 609              	.L45:
 610 002e 00BF     		.align	2
 611              	.L44:
 612 0030 D7B35D3F 		.word	1063105495
 613              		.cfi_endproc
 614              	.LFE169:
 616              		.section	.text.Park_Conv,"ax",%progbits
 617              		.align	1
 618              		.global	Park_Conv
 619              		.syntax unified
 620              		.thumb
 621              		.thumb_func
 622              		.fpu fpv4-sp-d16
 624              	Park_Conv:
 625              	.LVL43:
 626              	.LFB170:
 226:Src/foc.c     ****     float sin,cos;
 627              		.loc 1 226 73 is_stmt 1 view -0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 22


 628              		.cfi_startproc
 629              		@ args = 0, pretend = 0, frame = 8
 630              		@ frame_needed = 0, uses_anonymous_args = 0
 226:Src/foc.c     ****     float sin,cos;
 631              		.loc 1 226 73 is_stmt 0 view .LVU136
 632 0000 30B5     		push	{r4, r5, lr}
 633              	.LCFI9:
 634              		.cfi_def_cfa_offset 12
 635              		.cfi_offset 4, -12
 636              		.cfi_offset 5, -8
 637              		.cfi_offset 14, -4
 638 0002 2DED028B 		vpush.64	{d8}
 639              	.LCFI10:
 640              		.cfi_def_cfa_offset 20
 641              		.cfi_offset 80, -20
 642              		.cfi_offset 81, -16
 643 0006 83B0     		sub	sp, sp, #12
 644              	.LCFI11:
 645              		.cfi_def_cfa_offset 32
 646 0008 B0EE408A 		vmov.f32	s16, s0
 647 000c F0EE608A 		vmov.f32	s17, s1
 648 0010 0446     		mov	r4, r0
 649 0012 0D46     		mov	r5, r1
 227:Src/foc.c     ****     sin=cos=0;
 650              		.loc 1 227 5 is_stmt 1 view .LVU137
 228:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 651              		.loc 1 228 5 view .LVU138
 228:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 652              		.loc 1 228 12 is_stmt 0 view .LVU139
 653 0014 0023     		movs	r3, #0
 654 0016 0093     		str	r3, [sp]	@ float
 228:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 655              		.loc 1 228 8 view .LVU140
 656 0018 0193     		str	r3, [sp, #4]	@ float
 229:Src/foc.c     ****     *id = ialpha * cos + ibeta *sin;
 657              		.loc 1 229 5 is_stmt 1 view .LVU141
 658 001a 6946     		mov	r1, sp
 659              	.LVL44:
 229:Src/foc.c     ****     *id = ialpha * cos + ibeta *sin;
 660              		.loc 1 229 5 is_stmt 0 view .LVU142
 661 001c 01A8     		add	r0, sp, #4
 662              	.LVL45:
 229:Src/foc.c     ****     *id = ialpha * cos + ibeta *sin;
 663              		.loc 1 229 5 view .LVU143
 664 001e B0EE410A 		vmov.f32	s0, s2
 665              	.LVL46:
 229:Src/foc.c     ****     *id = ialpha * cos + ibeta *sin;
 666              		.loc 1 229 5 view .LVU144
 667 0022 FFF7FEFF 		bl	arm_sin_cos_f32
 668              	.LVL47:
 230:Src/foc.c     ****     *iq = -ialpha *sin + ibeta *cos;
 669              		.loc 1 230 5 is_stmt 1 view .LVU145
 230:Src/foc.c     ****     *iq = -ialpha *sin + ibeta *cos;
 670              		.loc 1 230 18 is_stmt 0 view .LVU146
 671 0026 DDED000A 		vldr.32	s1, [sp]
 672 002a 68EE207A 		vmul.f32	s15, s16, s1
 230:Src/foc.c     ****     *iq = -ialpha *sin + ibeta *cos;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 23


 673              		.loc 1 230 32 view .LVU147
 674 002e 9DED010A 		vldr.32	s0, [sp, #4]
 675 0032 28EE807A 		vmul.f32	s14, s17, s0
 230:Src/foc.c     ****     *iq = -ialpha *sin + ibeta *cos;
 676              		.loc 1 230 24 view .LVU148
 677 0036 77EE877A 		vadd.f32	s15, s15, s14
 230:Src/foc.c     ****     *iq = -ialpha *sin + ibeta *cos;
 678              		.loc 1 230 9 view .LVU149
 679 003a C5ED007A 		vstr.32	s15, [r5]
 231:Src/foc.c     **** }
 680              		.loc 1 231 5 is_stmt 1 view .LVU150
 231:Src/foc.c     **** }
 681              		.loc 1 231 19 is_stmt 0 view .LVU151
 682 003e 28EE408A 		vnmul.f32	s16, s16, s0
 683              	.LVL48:
 231:Src/foc.c     **** }
 684              		.loc 1 231 32 view .LVU152
 685 0042 68EEA08A 		vmul.f32	s17, s17, s1
 686              	.LVL49:
 231:Src/foc.c     **** }
 687              		.loc 1 231 24 view .LVU153
 688 0046 38EE288A 		vadd.f32	s16, s16, s17
 231:Src/foc.c     **** }
 689              		.loc 1 231 9 view .LVU154
 690 004a 84ED008A 		vstr.32	s16, [r4]
 232:Src/foc.c     **** 
 691              		.loc 1 232 1 view .LVU155
 692 004e 03B0     		add	sp, sp, #12
 693              	.LCFI12:
 694              		.cfi_def_cfa_offset 20
 695              		@ sp needed
 696 0050 BDEC028B 		vldm	sp!, {d8}
 697              	.LCFI13:
 698              		.cfi_restore 80
 699              		.cfi_restore 81
 700              		.cfi_def_cfa_offset 12
 701 0054 30BD     		pop	{r4, r5, pc}
 232:Src/foc.c     **** 
 702              		.loc 1 232 1 view .LVU156
 703              		.cfi_endproc
 704              	.LFE170:
 706              		.section	.text.Reverse_Park_Conv,"ax",%progbits
 707              		.align	1
 708              		.global	Reverse_Park_Conv
 709              		.syntax unified
 710              		.thumb
 711              		.thumb_func
 712              		.fpu fpv4-sp-d16
 714              	Reverse_Park_Conv:
 715              	.LVL50:
 716              	.LFB171:
 234:Src/foc.c     ****     float sin,cos;
 717              		.loc 1 234 77 is_stmt 1 view -0
 718              		.cfi_startproc
 719              		@ args = 0, pretend = 0, frame = 8
 720              		@ frame_needed = 0, uses_anonymous_args = 0
 234:Src/foc.c     ****     float sin,cos;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 24


 721              		.loc 1 234 77 is_stmt 0 view .LVU158
 722 0000 30B5     		push	{r4, r5, lr}
 723              	.LCFI14:
 724              		.cfi_def_cfa_offset 12
 725              		.cfi_offset 4, -12
 726              		.cfi_offset 5, -8
 727              		.cfi_offset 14, -4
 728 0002 2DED028B 		vpush.64	{d8}
 729              	.LCFI15:
 730              		.cfi_def_cfa_offset 20
 731              		.cfi_offset 80, -20
 732              		.cfi_offset 81, -16
 733 0006 83B0     		sub	sp, sp, #12
 734              	.LCFI16:
 735              		.cfi_def_cfa_offset 32
 736 0008 F0EE408A 		vmov.f32	s17, s0
 737 000c B0EE608A 		vmov.f32	s16, s1
 738 0010 0446     		mov	r4, r0
 739 0012 0D46     		mov	r5, r1
 235:Src/foc.c     ****     sin=cos=0;
 740              		.loc 1 235 5 is_stmt 1 view .LVU159
 236:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 741              		.loc 1 236 5 view .LVU160
 236:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 742              		.loc 1 236 12 is_stmt 0 view .LVU161
 743 0014 0023     		movs	r3, #0
 744 0016 0093     		str	r3, [sp]	@ float
 236:Src/foc.c     ****     arm_sin_cos_f32(theta,&sin,&cos);
 745              		.loc 1 236 8 view .LVU162
 746 0018 0193     		str	r3, [sp, #4]	@ float
 237:Src/foc.c     ****     *beta = d*sin + q*cos;
 747              		.loc 1 237 5 is_stmt 1 view .LVU163
 748 001a 6946     		mov	r1, sp
 749              	.LVL51:
 237:Src/foc.c     ****     *beta = d*sin + q*cos;
 750              		.loc 1 237 5 is_stmt 0 view .LVU164
 751 001c 01A8     		add	r0, sp, #4
 752              	.LVL52:
 237:Src/foc.c     ****     *beta = d*sin + q*cos;
 753              		.loc 1 237 5 view .LVU165
 754 001e B0EE410A 		vmov.f32	s0, s2
 755              	.LVL53:
 237:Src/foc.c     ****     *beta = d*sin + q*cos;
 756              		.loc 1 237 5 view .LVU166
 757 0022 FFF7FEFF 		bl	arm_sin_cos_f32
 758              	.LVL54:
 238:Src/foc.c     ****     *alpha = d*cos -q*sin;
 759              		.loc 1 238 5 is_stmt 1 view .LVU167
 238:Src/foc.c     ****     *alpha = d*cos -q*sin;
 760              		.loc 1 238 14 is_stmt 0 view .LVU168
 761 0026 9DED010A 		vldr.32	s0, [sp, #4]
 762 002a 68EE007A 		vmul.f32	s15, s16, s0
 238:Src/foc.c     ****     *alpha = d*cos -q*sin;
 763              		.loc 1 238 22 view .LVU169
 764 002e DDED000A 		vldr.32	s1, [sp]
 765 0032 28EEA07A 		vmul.f32	s14, s17, s1
 238:Src/foc.c     ****     *alpha = d*cos -q*sin;
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 25


 766              		.loc 1 238 19 view .LVU170
 767 0036 77EE877A 		vadd.f32	s15, s15, s14
 238:Src/foc.c     ****     *alpha = d*cos -q*sin;
 768              		.loc 1 238 11 view .LVU171
 769 003a C5ED007A 		vstr.32	s15, [r5]
 239:Src/foc.c     **** }
 770              		.loc 1 239 5 is_stmt 1 view .LVU172
 239:Src/foc.c     **** }
 771              		.loc 1 239 15 is_stmt 0 view .LVU173
 772 003e 28EE208A 		vmul.f32	s16, s16, s1
 773              	.LVL55:
 239:Src/foc.c     **** }
 774              		.loc 1 239 22 view .LVU174
 775 0042 68EE808A 		vmul.f32	s17, s17, s0
 776              	.LVL56:
 239:Src/foc.c     **** }
 777              		.loc 1 239 20 view .LVU175
 778 0046 38EE688A 		vsub.f32	s16, s16, s17
 239:Src/foc.c     **** }
 779              		.loc 1 239 12 view .LVU176
 780 004a 84ED008A 		vstr.32	s16, [r4]
 240:Src/foc.c     **** 
 781              		.loc 1 240 1 view .LVU177
 782 004e 03B0     		add	sp, sp, #12
 783              	.LCFI17:
 784              		.cfi_def_cfa_offset 20
 785              		@ sp needed
 786 0050 BDEC028B 		vldm	sp!, {d8}
 787              	.LCFI18:
 788              		.cfi_restore 80
 789              		.cfi_restore 81
 790              		.cfi_def_cfa_offset 12
 791 0054 30BD     		pop	{r4, r5, pc}
 240:Src/foc.c     **** 
 792              		.loc 1 240 1 view .LVU178
 793              		.cfi_endproc
 794              	.LFE171:
 796              		.section	.text.Current_Control,"ax",%progbits
 797              		.align	1
 798              		.global	Current_Control
 799              		.syntax unified
 800              		.thumb
 801              		.thumb_func
 802              		.fpu fpv4-sp-d16
 804              	Current_Control:
 805              	.LFB172:
 242:Src/foc.c     ****     float Ud=PID_Control(&Id_PID,Id_Set,id);
 806              		.loc 1 242 23 is_stmt 1 view -0
 807              		.cfi_startproc
 808              		@ args = 0, pretend = 0, frame = 8
 809              		@ frame_needed = 0, uses_anonymous_args = 0
 810 0000 00B5     		push	{lr}
 811              	.LCFI19:
 812              		.cfi_def_cfa_offset 4
 813              		.cfi_offset 14, -4
 814 0002 2DED028B 		vpush.64	{d8}
 815              	.LCFI20:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 26


 816              		.cfi_def_cfa_offset 12
 817              		.cfi_offset 80, -12
 818              		.cfi_offset 81, -8
 819 0006 83B0     		sub	sp, sp, #12
 820              	.LCFI21:
 821              		.cfi_def_cfa_offset 24
 243:Src/foc.c     ****     float Uq=PID_Control(&Iq_PID,Iq_Set,iq);
 822              		.loc 1 243 5 view .LVU180
 243:Src/foc.c     ****     float Uq=PID_Control(&Iq_PID,Iq_Set,iq);
 823              		.loc 1 243 14 is_stmt 0 view .LVU181
 824 0008 2B4B     		ldr	r3, .L58
 825 000a D3ED000A 		vldr.32	s1, [r3]
 826 000e 2B4B     		ldr	r3, .L58+4
 827 0010 93ED000A 		vldr.32	s0, [r3]
 828 0014 2A48     		ldr	r0, .L58+8
 829 0016 FFF7FEFF 		bl	PID_Control
 830              	.LVL57:
 831 001a B0EE408A 		vmov.f32	s16, s0
 832              	.LVL58:
 244:Src/foc.c     **** 
 833              		.loc 1 244 5 is_stmt 1 view .LVU182
 244:Src/foc.c     **** 
 834              		.loc 1 244 14 is_stmt 0 view .LVU183
 835 001e 294B     		ldr	r3, .L58+12
 836 0020 D3ED000A 		vldr.32	s1, [r3]
 837 0024 284B     		ldr	r3, .L58+16
 838 0026 93ED000A 		vldr.32	s0, [r3]
 839              	.LVL59:
 244:Src/foc.c     **** 
 840              		.loc 1 244 14 view .LVU184
 841 002a 2848     		ldr	r0, .L58+20
 842 002c FFF7FEFF 		bl	PID_Control
 843              	.LVL60:
 246:Src/foc.c     ****     Reverse_Park_Conv(Uq,Ud,Position_Phase_Degree,&Ualpha,&Ubeta);
 844              		.loc 1 246 5 is_stmt 1 view .LVU185
 247:Src/foc.c     ****     float target_theta= atan2f(Ubeta,Ualpha)*180.0f/3.1415926f;
 845              		.loc 1 247 5 view .LVU186
 846 0030 6946     		mov	r1, sp
 847 0032 01A8     		add	r0, sp, #4
 848 0034 264B     		ldr	r3, .L58+24
 849 0036 93ED001A 		vldr.32	s2, [r3]
 850 003a F0EE480A 		vmov.f32	s1, s16
 851 003e FFF7FEFF 		bl	Reverse_Park_Conv
 852              	.LVL61:
 248:Src/foc.c     ****     if(target_theta<0){
 853              		.loc 1 248 5 view .LVU187
 248:Src/foc.c     ****     if(target_theta<0){
 854              		.loc 1 248 25 is_stmt 0 view .LVU188
 855 0042 DDED010A 		vldr.32	s1, [sp, #4]
 856 0046 9DED000A 		vldr.32	s0, [sp]
 857 004a FFF7FEFF 		bl	atan2f
 858              	.LVL62:
 248:Src/foc.c     ****     if(target_theta<0){
 859              		.loc 1 248 45 view .LVU189
 860 004e DFED217A 		vldr.32	s15, .L58+28
 861 0052 20EE270A 		vmul.f32	s0, s0, s15
 248:Src/foc.c     ****     if(target_theta<0){
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 27


 862              		.loc 1 248 11 view .LVU190
 863 0056 DFED207A 		vldr.32	s15, .L58+32
 864 005a 80EE278A 		vdiv.f32	s16, s0, s15
 865              	.LVL63:
 249:Src/foc.c     ****         target_theta+=360;
 866              		.loc 1 249 5 is_stmt 1 view .LVU191
 249:Src/foc.c     ****         target_theta+=360;
 867              		.loc 1 249 7 is_stmt 0 view .LVU192
 868 005e B5EEC08A 		vcmpe.f32	s16, #0
 869 0062 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 870 0066 21D4     		bmi	.L57
 871              	.L51:
 252:Src/foc.c     ****     
 872              		.loc 1 252 5 is_stmt 1 view .LVU193
 252:Src/foc.c     ****     
 873              		.loc 1 252 32 is_stmt 0 view .LVU194
 874 0068 9DED010A 		vldr.32	s0, [sp, #4]
 875 006c 20EE000A 		vmul.f32	s0, s0, s0
 252:Src/foc.c     ****     
 876              		.loc 1 252 45 view .LVU195
 877 0070 DDED007A 		vldr.32	s15, [sp]
 878 0074 67EEA77A 		vmul.f32	s15, s15, s15
 252:Src/foc.c     ****     
 879              		.loc 1 252 20 view .LVU196
 880 0078 30EE270A 		vadd.f32	s0, s0, s15
 881 007c FFF7FEFF 		bl	sqrtf
 882              	.LVL64:
 254:Src/foc.c     ****         length=8;
 883              		.loc 1 254 5 is_stmt 1 view .LVU197
 254:Src/foc.c     ****         length=8;
 884              		.loc 1 254 7 is_stmt 0 view .LVU198
 885 0080 F2EE007A 		vmov.f32	s15, #8.0e+0
 886 0084 B4EEE70A 		vcmpe.f32	s0, s15
 887 0088 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 888 008c 01DD     		ble	.L53
 255:Src/foc.c     ****     }
 889              		.loc 1 255 15 view .LVU199
 890 008e B0EE670A 		vmov.f32	s0, s15
 891              	.LVL65:
 892              	.L53:
 259:Src/foc.c     ****     //SVPWM(Position_Phase_Degree+90,0.1);
 893              		.loc 1 259 5 is_stmt 1 view .LVU200
 264:Src/foc.c     **** }
 894              		.loc 1 264 5 view .LVU201
 895 0092 F4EE000A 		vmov.f32	s1, #1.25e-1
 896 0096 60EE200A 		vmul.f32	s1, s0, s1
 897 009a B0EE480A 		vmov.f32	s0, s16
 898              	.LVL66:
 264:Src/foc.c     **** }
 899              		.loc 1 264 5 is_stmt 0 view .LVU202
 900 009e FFF7FEFF 		bl	SVPWM
 901              	.LVL67:
 265:Src/foc.c     **** 
 902              		.loc 1 265 1 view .LVU203
 903 00a2 03B0     		add	sp, sp, #12
 904              	.LCFI22:
 905              		.cfi_remember_state
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 28


 906              		.cfi_def_cfa_offset 12
 907              		@ sp needed
 908 00a4 BDEC028B 		vldm	sp!, {d8}
 909              	.LCFI23:
 910              		.cfi_restore 80
 911              		.cfi_restore 81
 912              		.cfi_def_cfa_offset 4
 913              	.LVL68:
 265:Src/foc.c     **** 
 914              		.loc 1 265 1 view .LVU204
 915 00a8 5DF804FB 		ldr	pc, [sp], #4
 916              	.LVL69:
 917              	.L57:
 918              	.LCFI24:
 919              		.cfi_restore_state
 250:Src/foc.c     ****     }
 920              		.loc 1 250 9 is_stmt 1 view .LVU205
 250:Src/foc.c     ****     }
 921              		.loc 1 250 21 is_stmt 0 view .LVU206
 922 00ac DFED0B7A 		vldr.32	s15, .L58+36
 923 00b0 38EE278A 		vadd.f32	s16, s16, s15
 924              	.LVL70:
 250:Src/foc.c     ****     }
 925              		.loc 1 250 21 view .LVU207
 926 00b4 D8E7     		b	.L51
 927              	.L59:
 928 00b6 00BF     		.align	2
 929              	.L58:
 930 00b8 00000000 		.word	id
 931 00bc 00000000 		.word	.LANCHOR10
 932 00c0 00000000 		.word	.LANCHOR6
 933 00c4 00000000 		.word	iq
 934 00c8 00000000 		.word	.LANCHOR4
 935 00cc 00000000 		.word	.LANCHOR5
 936 00d0 00000000 		.word	Position_Phase_Degree
 937 00d4 00003443 		.word	1127481344
 938 00d8 DA0F4940 		.word	1078530010
 939 00dc 0000B443 		.word	1135869952
 940              		.cfi_endproc
 941              	.LFE172:
 943              		.section	.text.HAL_ADC_ConvCpltCallback,"ax",%progbits
 944              		.align	1
 945              		.global	HAL_ADC_ConvCpltCallback
 946              		.syntax unified
 947              		.thumb
 948              		.thumb_func
 949              		.fpu fpv4-sp-d16
 951              	HAL_ADC_ConvCpltCallback:
 952              	.LVL71:
 953              	.LFB173:
 273:Src/foc.c     ****     float temp_iq,temp_id;
 954              		.loc 1 273 55 is_stmt 1 view -0
 955              		.cfi_startproc
 956              		@ args = 0, pretend = 0, frame = 8
 957              		@ frame_needed = 0, uses_anonymous_args = 0
 274:Src/foc.c     ****     float temp_current,temp_current1;
 958              		.loc 1 274 5 view .LVU209
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 29


 275:Src/foc.c     ****     static int current_control_cnt=0;
 959              		.loc 1 275 5 view .LVU210
 276:Src/foc.c     **** 
 960              		.loc 1 276 5 view .LVU211
 278:Src/foc.c     ****         Check_Mode();
 961              		.loc 1 278 5 view .LVU212
 278:Src/foc.c     ****         Check_Mode();
 962              		.loc 1 278 12 is_stmt 0 view .LVU213
 963 0000 0268     		ldr	r2, [r0]
 278:Src/foc.c     ****         Check_Mode();
 964              		.loc 1 278 7 view .LVU214
 965 0002 C34B     		ldr	r3, .L82+8
 966 0004 9A42     		cmp	r2, r3
 967 0006 00D0     		beq	.L75
 968 0008 7047     		bx	lr
 969              	.L75:
 273:Src/foc.c     ****     float temp_iq,temp_id;
 970              		.loc 1 273 55 view .LVU215
 971 000a 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 972              	.LCFI25:
 973              		.cfi_def_cfa_offset 28
 974              		.cfi_offset 4, -28
 975              		.cfi_offset 5, -24
 976              		.cfi_offset 6, -20
 977              		.cfi_offset 7, -16
 978              		.cfi_offset 8, -12
 979              		.cfi_offset 9, -8
 980              		.cfi_offset 14, -4
 981 000e 2DED068B 		vpush.64	{d8, d9, d10}
 982              	.LCFI26:
 983              		.cfi_def_cfa_offset 52
 984              		.cfi_offset 80, -52
 985              		.cfi_offset 81, -48
 986              		.cfi_offset 82, -44
 987              		.cfi_offset 83, -40
 988              		.cfi_offset 84, -36
 989              		.cfi_offset 85, -32
 990 0012 83B0     		sub	sp, sp, #12
 991              	.LCFI27:
 992              		.cfi_def_cfa_offset 64
 279:Src/foc.c     ****         if(current_control_cnt%Position_Control_CNT_MAX==0){
 993              		.loc 1 279 9 is_stmt 1 view .LVU216
 994              	.LBB20:
 995              	.LBI20:
 493:Src/foc.c     **** 
 494:Src/foc.c     **** inline void Mode_Enter_Init(){
 495:Src/foc.c     ****     switch(Board_Mode){
 496:Src/foc.c     ****         case IDLE:
 497:Src/foc.c     ****             FOC_STOP();
 498:Src/foc.c     ****         break;
 499:Src/foc.c     ****         default:
 500:Src/foc.c     ****             PID_I_Clear();
 501:Src/foc.c     ****         break;
 502:Src/foc.c     ****     }
 503:Src/foc.c     ****     Last_Mode = Board_Mode;
 504:Src/foc.c     **** }
 505:Src/foc.c     **** 
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 30


 506:Src/foc.c     **** inline void Check_Mode(){
 996              		.loc 1 506 13 view .LVU217
 997              	.LBB21:
 507:Src/foc.c     ****     if(Last_Mode !=Board_Mode){
 998              		.loc 1 507 5 view .LVU218
 999              		.loc 1 507 18 is_stmt 0 view .LVU219
 1000 0014 BF4B     		ldr	r3, .L82+12
 1001 0016 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1002 0018 BF4B     		ldr	r3, .L82+16
 1003 001a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1004              		.loc 1 507 7 view .LVU220
 1005 001c 9A42     		cmp	r2, r3
 1006 001e 40F01E81 		bne	.L76
 1007              	.LVL72:
 1008              	.L62:
 1009              		.loc 1 507 7 view .LVU221
 1010              	.LBE21:
 1011              	.LBE20:
 280:Src/foc.c     ****            if(Board_Mode == POSITION){
 1012              		.loc 1 280 9 is_stmt 1 view .LVU222
 280:Src/foc.c     ****            if(Board_Mode == POSITION){
 1013              		.loc 1 280 56 is_stmt 0 view .LVU223
 1014 0022 BE4B     		ldr	r3, .L82+20
 1015 0024 1B68     		ldr	r3, [r3]
 280:Src/foc.c     ****            if(Board_Mode == POSITION){
 1016              		.loc 1 280 11 view .LVU224
 1017 0026 13F0010F 		tst	r3, #1
 1018 002a 04D1     		bne	.L65
 281:Src/foc.c     ****                 Position_Control();
 1019              		.loc 1 281 12 is_stmt 1 view .LVU225
 281:Src/foc.c     ****                 Position_Control();
 1020              		.loc 1 281 26 is_stmt 0 view .LVU226
 1021 002c BA4B     		ldr	r3, .L82+16
 1022 002e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 281:Src/foc.c     ****                 Position_Control();
 1023              		.loc 1 281 14 view .LVU227
 1024 0030 062B     		cmp	r3, #6
 1025 0032 00F02581 		beq	.L77
 1026              	.L65:
 285:Src/foc.c     ****             if(Board_Mode >= SPEED){
 1027              		.loc 1 285 9 is_stmt 1 view .LVU228
 285:Src/foc.c     ****             if(Board_Mode >= SPEED){
 1028              		.loc 1 285 53 is_stmt 0 view .LVU229
 1029 0036 B94B     		ldr	r3, .L82+20
 1030 0038 1B68     		ldr	r3, [r3]
 285:Src/foc.c     ****             if(Board_Mode >= SPEED){
 1031              		.loc 1 285 11 view .LVU230
 1032 003a 13F0010F 		tst	r3, #1
 1033 003e 04D1     		bne	.L66
 286:Src/foc.c     ****                 Speed_Control();
 1034              		.loc 1 286 13 is_stmt 1 view .LVU231
 286:Src/foc.c     ****                 Speed_Control();
 1035              		.loc 1 286 27 is_stmt 0 view .LVU232
 1036 0040 B54B     		ldr	r3, .L82+16
 1037 0042 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 286:Src/foc.c     ****                 Speed_Control();
 1038              		.loc 1 286 15 view .LVU233
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 31


 1039 0044 042B     		cmp	r3, #4
 1040 0046 00F21E81 		bhi	.L78
 1041              	.L66:
 290:Src/foc.c     ****         if(current_control_cnt==FOC_FREQ/2/2){
 1042              		.loc 1 290 9 is_stmt 1 view .LVU234
 290:Src/foc.c     ****         if(current_control_cnt==FOC_FREQ/2/2){
 1043              		.loc 1 290 28 is_stmt 0 view .LVU235
 1044 004a B44A     		ldr	r2, .L82+20
 1045 004c 1368     		ldr	r3, [r2]
 1046 004e 0133     		adds	r3, r3, #1
 1047 0050 1360     		str	r3, [r2]
 291:Src/foc.c     ****             current_control_cnt=0;
 1048              		.loc 1 291 9 is_stmt 1 view .LVU236
 291:Src/foc.c     ****             current_control_cnt=0;
 1049              		.loc 1 291 11 is_stmt 0 view .LVU237
 1050 0052 B3F5FA6F 		cmp	r3, #2000
 1051 0056 00F01981 		beq	.L79
 1052              	.L67:
 294:Src/foc.c     **** 
 1053              		.loc 1 294 9 is_stmt 1 view .LVU238
 1054 005a B14E     		ldr	r6, .L82+24
 1055 005c 0122     		movs	r2, #1
 1056 005e 4FF40071 		mov	r1, #512
 1057 0062 3046     		mov	r0, r6
 1058 0064 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1059              	.LVL73:
 296:Src/foc.c     ****         UTILS_LP_FAST(current[1],GET_CURRENT(1),0.1);
 1060              		.loc 1 296 9 view .LVU239
 1061 0068 AE4C     		ldr	r4, .L82+28
 1062 006a 94ED008A 		vldr.32	s16, [r4]
 1063 006e AE4D     		ldr	r5, .L82+32
 1064 0070 B5F90030 		ldrsh	r3, [r5]
 1065 0074 AD4F     		ldr	r7, .L82+36
 1066 0076 B7F90020 		ldrsh	r2, [r7]
 1067 007a 9B1A     		subs	r3, r3, r2
 1068 007c 07EE903A 		vmov	s15, r3	@ int
 1069 0080 F8EEE77A 		vcvt.f32.s32	s15, s15
 1070 0084 9FEDAA9A 		vldr.32	s18, .L82+40
 1071 0088 67EE897A 		vmul.f32	s15, s15, s18
 1072 008c DFEDA98A 		vldr.32	s17, .L82+44
 1073 0090 67EEA87A 		vmul.f32	s15, s15, s17
 1074 0094 DFEDA8AA 		vldr.32	s21, .L82+48
 1075 0098 87EEAA7A 		vdiv.f32	s14, s15, s21
 1076 009c 9FEDA7AA 		vldr.32	s20, .L82+52
 1077 00a0 C7EE0A7A 		vdiv.f32	s15, s14, s20
 1078 00a4 78EE677A 		vsub.f32	s15, s16, s15
 1079 00a8 17EE900A 		vmov	r0, s15
 1080 00ac FFF7FEFF 		bl	__aeabi_f2d
 1081              	.LVL74:
 1082 00b0 95A3     		adr	r3, .L82
 1083 00b2 D3E90023 		ldrd	r2, [r3]
 1084 00b6 FFF7FEFF 		bl	__aeabi_dmul
 1085              	.LVL75:
 1086 00ba 8046     		mov	r8, r0
 1087 00bc 8946     		mov	r9, r1
 1088 00be 18EE100A 		vmov	r0, s16
 1089 00c2 FFF7FEFF 		bl	__aeabi_f2d
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 32


 1090              	.LVL76:
 1091 00c6 4246     		mov	r2, r8
 1092 00c8 4B46     		mov	r3, r9
 1093 00ca FFF7FEFF 		bl	__aeabi_dsub
 1094              	.LVL77:
 1095 00ce FFF7FEFF 		bl	__aeabi_d2f
 1096              	.LVL78:
 1097 00d2 08EE100A 		vmov	s16, r0
 1098 00d6 2060     		str	r0, [r4]	@ float
 297:Src/foc.c     **** 
 1099              		.loc 1 297 9 view .LVU240
 1100 00d8 D4ED019A 		vldr.32	s19, [r4, #4]
 1101 00dc B5F90230 		ldrsh	r3, [r5, #2]
 1102 00e0 B7F90220 		ldrsh	r2, [r7, #2]
 1103 00e4 9B1A     		subs	r3, r3, r2
 1104 00e6 07EE903A 		vmov	s15, r3	@ int
 1105 00ea F8EEE77A 		vcvt.f32.s32	s15, s15
 1106 00ee 67EE897A 		vmul.f32	s15, s15, s18
 1107 00f2 67EEA87A 		vmul.f32	s15, s15, s17
 1108 00f6 87EEAA7A 		vdiv.f32	s14, s15, s21
 1109 00fa C7EE0A7A 		vdiv.f32	s15, s14, s20
 1110 00fe 79EEE77A 		vsub.f32	s15, s19, s15
 1111 0102 17EE900A 		vmov	r0, s15
 1112 0106 FFF7FEFF 		bl	__aeabi_f2d
 1113              	.LVL79:
 1114 010a 7FA3     		adr	r3, .L82
 1115 010c D3E90023 		ldrd	r2, [r3]
 1116 0110 FFF7FEFF 		bl	__aeabi_dmul
 1117              	.LVL80:
 1118 0114 8046     		mov	r8, r0
 1119 0116 8946     		mov	r9, r1
 1120 0118 19EE900A 		vmov	r0, s19
 1121 011c FFF7FEFF 		bl	__aeabi_f2d
 1122              	.LVL81:
 1123 0120 4246     		mov	r2, r8
 1124 0122 4B46     		mov	r3, r9
 1125 0124 FFF7FEFF 		bl	__aeabi_dsub
 1126              	.LVL82:
 1127 0128 FFF7FEFF 		bl	__aeabi_d2f
 1128              	.LVL83:
 1129 012c 00EE100A 		vmov	s0, r0
 1130 0130 6060     		str	r0, [r4, #4]	@ float
 299:Src/foc.c     **** 
 1131              		.loc 1 299 9 view .LVU241
 299:Src/foc.c     **** 
 1132              		.loc 1 299 25 is_stmt 0 view .LVU242
 1133 0132 B5F90430 		ldrsh	r3, [r5, #4]
 1134 0136 07EE903A 		vmov	s15, r3	@ int
 1135 013a F8EEE77A 		vcvt.f32.s32	s15, s15
 1136 013e 67EE897A 		vmul.f32	s15, s15, s18
 1137 0142 67EEA87A 		vmul.f32	s15, s15, s17
 299:Src/foc.c     **** 
 1138              		.loc 1 299 64 view .LVU243
 1139 0146 9FED7E7A 		vldr.32	s14, .L82+56
 1140 014a 67EE877A 		vmul.f32	s15, s15, s14
 299:Src/foc.c     **** 
 1141              		.loc 1 299 92 view .LVU244
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 33


 1142 014e DFED7D6A 		vldr.32	s13, .L82+60
 1143 0152 87EEA67A 		vdiv.f32	s14, s15, s13
 299:Src/foc.c     **** 
 1144              		.loc 1 299 23 view .LVU245
 1145 0156 7C4B     		ldr	r3, .L82+64
 1146 0158 83ED007A 		vstr.32	s14, [r3]
 301:Src/foc.c     ****     
 1147              		.loc 1 301 9 is_stmt 1 view .LVU246
 1148 015c 7B4D     		ldr	r5, .L82+68
 1149 015e 7C4C     		ldr	r4, .L82+72
 1150 0160 2946     		mov	r1, r5
 1151 0162 2046     		mov	r0, r4
 1152 0164 F0EE480A 		vmov.f32	s1, s16
 1153 0168 FFF7FEFF 		bl	Clark_Conv
 1154              	.LVL84:
 303:Src/foc.c     ****         Get_Speed();
 1155              		.loc 1 303 9 view .LVU247
 303:Src/foc.c     ****         Get_Speed();
 1156              		.loc 1 303 20 is_stmt 0 view .LVU248
 1157 016c FFF7FEFF 		bl	Get_Position
 1158              	.LVL85:
 303:Src/foc.c     ****         Get_Speed();
 1159              		.loc 1 303 18 view .LVU249
 1160 0170 784F     		ldr	r7, .L82+76
 1161 0172 3880     		strh	r0, [r7]	@ movhi
 304:Src/foc.c     ****         Position_Degree = Position_to_Rad_Dgree(Position,1);
 1162              		.loc 1 304 9 is_stmt 1 view .LVU250
 1163 0174 FFF7FEFF 		bl	Get_Speed
 1164              	.LVL86:
 305:Src/foc.c     ****         Position_Phase_Degree = Position_Degree * Motor.Pairs-Motor.Position_Phase_Offset;
 1165              		.loc 1 305 9 view .LVU251
 305:Src/foc.c     ****         Position_Phase_Degree = Position_Degree * Motor.Pairs-Motor.Position_Phase_Offset;
 1166              		.loc 1 305 27 is_stmt 0 view .LVU252
 1167 0178 0121     		movs	r1, #1
 1168 017a 3888     		ldrh	r0, [r7]
 1169 017c FFF7FEFF 		bl	Position_to_Rad_Dgree
 1170              	.LVL87:
 305:Src/foc.c     ****         Position_Phase_Degree = Position_Degree * Motor.Pairs-Motor.Position_Phase_Offset;
 1171              		.loc 1 305 25 view .LVU253
 1172 0180 754B     		ldr	r3, .L82+80
 1173 0182 83ED000A 		vstr.32	s0, [r3]
 306:Src/foc.c     **** 
 1174              		.loc 1 306 9 is_stmt 1 view .LVU254
 306:Src/foc.c     **** 
 1175              		.loc 1 306 56 is_stmt 0 view .LVU255
 1176 0186 754B     		ldr	r3, .L82+84
 1177 0188 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1178 018a 01EE102A 		vmov	s2, r2	@ int
 306:Src/foc.c     **** 
 1179              		.loc 1 306 49 view .LVU256
 1180 018e B8EEC11A 		vcvt.f32.s32	s2, s2
 1181 0192 21EE001A 		vmul.f32	s2, s2, s0
 306:Src/foc.c     **** 
 1182              		.loc 1 306 68 view .LVU257
 1183 0196 93ED010A 		vldr.32	s0, [r3, #4]
 306:Src/foc.c     **** 
 1184              		.loc 1 306 62 view .LVU258
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 34


 1185 019a 31EE401A 		vsub.f32	s2, s2, s0
 306:Src/foc.c     **** 
 1186              		.loc 1 306 31 view .LVU259
 1187 019e 704B     		ldr	r3, .L82+88
 1188 01a0 83ED001A 		vstr.32	s2, [r3]
 308:Src/foc.c     ****         UTILS_LP_FAST(iq,temp_iq,0.1);
 1189              		.loc 1 308 9 is_stmt 1 view .LVU260
 1190 01a4 6946     		mov	r1, sp
 1191 01a6 01A8     		add	r0, sp, #4
 1192 01a8 D5ED000A 		vldr.32	s1, [r5]
 1193 01ac 94ED000A 		vldr.32	s0, [r4]
 1194 01b0 FFF7FEFF 		bl	Park_Conv
 1195              	.LVL88:
 309:Src/foc.c     ****         UTILS_LP_FAST(id,temp_id,0.1);
 1196              		.loc 1 309 9 view .LVU261
 1197 01b4 6B4F     		ldr	r7, .L82+92
 1198 01b6 97ED008A 		vldr.32	s16, [r7]
 1199 01ba DDED017A 		vldr.32	s15, [sp, #4]
 1200 01be 78EE677A 		vsub.f32	s15, s16, s15
 1201 01c2 17EE900A 		vmov	r0, s15
 1202 01c6 FFF7FEFF 		bl	__aeabi_f2d
 1203              	.LVL89:
 1204 01ca 4FA3     		adr	r3, .L82
 1205 01cc D3E90023 		ldrd	r2, [r3]
 1206 01d0 FFF7FEFF 		bl	__aeabi_dmul
 1207              	.LVL90:
 1208 01d4 0446     		mov	r4, r0
 1209 01d6 0D46     		mov	r5, r1
 1210 01d8 18EE100A 		vmov	r0, s16
 1211 01dc FFF7FEFF 		bl	__aeabi_f2d
 1212              	.LVL91:
 1213 01e0 2246     		mov	r2, r4
 1214 01e2 2B46     		mov	r3, r5
 1215 01e4 FFF7FEFF 		bl	__aeabi_dsub
 1216              	.LVL92:
 1217 01e8 FFF7FEFF 		bl	__aeabi_d2f
 1218              	.LVL93:
 1219 01ec 3860     		str	r0, [r7]	@ float
 310:Src/foc.c     ****         HAL_GPIO_WritePin(GPIOC,LED_GREEN_Pin,GPIO_PIN_RESET);   
 1220              		.loc 1 310 9 view .LVU262
 1221 01ee 5E4F     		ldr	r7, .L82+96
 1222 01f0 97ED008A 		vldr.32	s16, [r7]
 1223 01f4 DDED007A 		vldr.32	s15, [sp]
 1224 01f8 78EE677A 		vsub.f32	s15, s16, s15
 1225 01fc 17EE900A 		vmov	r0, s15
 1226 0200 FFF7FEFF 		bl	__aeabi_f2d
 1227              	.LVL94:
 1228 0204 40A3     		adr	r3, .L82
 1229 0206 D3E90023 		ldrd	r2, [r3]
 1230 020a FFF7FEFF 		bl	__aeabi_dmul
 1231              	.LVL95:
 1232 020e 0446     		mov	r4, r0
 1233 0210 0D46     		mov	r5, r1
 1234 0212 18EE100A 		vmov	r0, s16
 1235 0216 FFF7FEFF 		bl	__aeabi_f2d
 1236              	.LVL96:
 1237 021a 2246     		mov	r2, r4
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 35


 1238 021c 2B46     		mov	r3, r5
 1239 021e FFF7FEFF 		bl	__aeabi_dsub
 1240              	.LVL97:
 1241 0222 FFF7FEFF 		bl	__aeabi_d2f
 1242              	.LVL98:
 1243 0226 3860     		str	r0, [r7]	@ float
 311:Src/foc.c     **** 
 1244              		.loc 1 311 9 view .LVU263
 1245 0228 0022     		movs	r2, #0
 1246 022a 4FF40071 		mov	r1, #512
 1247 022e 3046     		mov	r0, r6
 1248 0230 FFF7FEFF 		bl	HAL_GPIO_WritePin
 1249              	.LVL99:
 317:Src/foc.c     ****             if(Board_Mode>=CURRENT){
 1250              		.loc 1 317 9 view .LVU264
 317:Src/foc.c     ****             if(Board_Mode>=CURRENT){
 1251              		.loc 1 317 12 is_stmt 0 view .LVU265
 1252 0234 4D4B     		ldr	r3, .L82+100
 1253 0236 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 317:Src/foc.c     ****             if(Board_Mode>=CURRENT){
 1254              		.loc 1 317 11 view .LVU266
 1255 0238 002B     		cmp	r3, #0
 1256 023a 59D0     		beq	.L68
 318:Src/foc.c     ****                 Current_Control();
 1257              		.loc 1 318 13 is_stmt 1 view .LVU267
 318:Src/foc.c     ****                 Current_Control();
 1258              		.loc 1 318 26 is_stmt 0 view .LVU268
 1259 023c 364B     		ldr	r3, .L82+16
 1260 023e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 318:Src/foc.c     ****                 Current_Control();
 1261              		.loc 1 318 15 view .LVU269
 1262 0240 032B     		cmp	r3, #3
 1263 0242 27D8     		bhi	.L80
 320:Src/foc.c     ****                 float duty = Base_Duty + Duty_Amp * arm_cos_f32((Position_Degree-Position_Offset-Ph
 1264              		.loc 1 320 19 is_stmt 1 view .LVU270
 320:Src/foc.c     ****                 float duty = Base_Duty + Duty_Amp * arm_cos_f32((Position_Degree-Position_Offset-Ph
 1265              		.loc 1 320 21 is_stmt 0 view .LVU271
 1266 0244 022B     		cmp	r3, #2
 1267 0246 28D0     		beq	.L81
 1268              	.L70:
 329:Src/foc.c     ****         send_debug_wave(&wg2);
 1269              		.loc 1 329 9 is_stmt 1 view .LVU272
 1270 0248 4948     		ldr	r0, .L82+104
 1271 024a FFF7FEFF 		bl	send_debug_wave
 1272              	.LVL100:
 330:Src/foc.c     **** 
 1273              		.loc 1 330 9 view .LVU273
 1274 024e 4948     		ldr	r0, .L82+108
 1275 0250 FFF7FEFF 		bl	send_debug_wave
 1276              	.LVL101:
 344:Src/foc.c     **** 
 1277              		.loc 1 344 1 is_stmt 0 view .LVU274
 1278 0254 03B0     		add	sp, sp, #12
 1279              	.LCFI28:
 1280              		.cfi_remember_state
 1281              		.cfi_def_cfa_offset 52
 1282              		@ sp needed
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 36


 1283 0256 BDEC068B 		vldm	sp!, {d8-d10}
 1284              	.LCFI29:
 1285              		.cfi_restore 84
 1286              		.cfi_restore 85
 1287              		.cfi_restore 82
 1288              		.cfi_restore 83
 1289              		.cfi_restore 80
 1290              		.cfi_restore 81
 1291              		.cfi_def_cfa_offset 28
 1292 025a BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 1293              	.LVL102:
 1294              	.L76:
 1295              	.LCFI30:
 1296              		.cfi_restore_state
 1297              	.LBB27:
 1298              	.LBB26:
 508:Src/foc.c     ****         Mode_Enter_Init();
 1299              		.loc 1 508 9 is_stmt 1 view .LVU275
 1300              	.LBB22:
 1301              	.LBI22:
 494:Src/foc.c     ****     switch(Board_Mode){
 1302              		.loc 1 494 13 view .LVU276
 1303              	.LBB23:
 495:Src/foc.c     ****         case IDLE:
 1304              		.loc 1 495 5 view .LVU277
 1305 025e 2E4B     		ldr	r3, .L82+16
 1306 0260 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 1307 0262 53B9     		cbnz	r3, .L63
 497:Src/foc.c     ****         break;
 1308              		.loc 1 497 13 view .LVU278
 1309 0264 444B     		ldr	r3, .L82+112
 1310 0266 9FED450A 		vldr.32	s0, .L82+116
 1311 026a 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1312              	.LVL103:
 497:Src/foc.c     ****         break;
 1313              		.loc 1 497 13 is_stmt 0 view .LVU279
 1314 026c FFF7FEFF 		bl	Set_Vector
 1315              	.LVL104:
 498:Src/foc.c     ****         default:
 1316              		.loc 1 498 9 is_stmt 1 view .LVU280
 1317              	.L64:
 503:Src/foc.c     **** }
 1318              		.loc 1 503 5 view .LVU281
 503:Src/foc.c     **** }
 1319              		.loc 1 503 15 is_stmt 0 view .LVU282
 1320 0270 294B     		ldr	r3, .L82+16
 1321 0272 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 1322 0274 274B     		ldr	r3, .L82+12
 1323 0276 1A70     		strb	r2, [r3]
 1324              	.LBE23:
 1325              	.LBE22:
 509:Src/foc.c     ****         Last_Mode = Board_Mode;
 1326              		.loc 1 509 9 is_stmt 1 view .LVU283
 1327 0278 D3E6     		b	.L62
 1328              	.LVL105:
 1329              	.L63:
 1330              	.LBB25:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 37


 1331              	.LBB24:
 500:Src/foc.c     ****         break;
 1332              		.loc 1 500 13 view .LVU284
 1333 027a FFF7FEFF 		bl	PID_I_Clear
 1334              	.LVL106:
 501:Src/foc.c     ****     }
 1335              		.loc 1 501 9 view .LVU285
 1336 027e F7E7     		b	.L64
 1337              	.L77:
 1338              	.LBE24:
 1339              	.LBE25:
 1340              	.LBE26:
 1341              	.LBE27:
 282:Src/foc.c     ****             }
 1342              		.loc 1 282 17 view .LVU286
 1343 0280 FFF7FEFF 		bl	Position_Control
 1344              	.LVL107:
 1345 0284 D7E6     		b	.L65
 1346              	.L78:
 287:Src/foc.c     ****             }
 1347              		.loc 1 287 17 view .LVU287
 1348 0286 FFF7FEFF 		bl	Speed_Control
 1349              	.LVL108:
 1350 028a DEE6     		b	.L66
 1351              	.L79:
 292:Src/foc.c     ****         }
 1352              		.loc 1 292 13 view .LVU288
 292:Src/foc.c     ****         }
 1353              		.loc 1 292 32 is_stmt 0 view .LVU289
 1354 028c 1346     		mov	r3, r2
 1355 028e 0022     		movs	r2, #0
 1356 0290 1A60     		str	r2, [r3]
 1357 0292 E2E6     		b	.L67
 1358              	.L80:
 319:Src/foc.c     ****             }else if(Board_Mode == DUTY){
 1359              		.loc 1 319 17 is_stmt 1 view .LVU290
 1360 0294 FFF7FEFF 		bl	Current_Control
 1361              	.LVL109:
 1362 0298 D6E7     		b	.L70
 1363              	.L81:
 1364              	.LBB28:
 321:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 1365              		.loc 1 321 17 view .LVU291
 321:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 1366              		.loc 1 321 81 is_stmt 0 view .LVU292
 1367 029a 2F4B     		ldr	r3, .L82+80
 1368 029c D3ED007A 		vldr.32	s15, [r3]
 1369 02a0 374B     		ldr	r3, .L82+120
 1370 02a2 93ED007A 		vldr.32	s14, [r3]
 1371 02a6 77EEC77A 		vsub.f32	s15, s15, s14
 321:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 1372              		.loc 1 321 97 view .LVU293
 1373 02aa 364B     		ldr	r3, .L82+124
 1374 02ac 93ED007A 		vldr.32	s14, [r3]
 1375 02b0 77EEC77A 		vsub.f32	s15, s15, s14
 321:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 1376              		.loc 1 321 102 view .LVU294
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 38


 1377 02b4 9FED347A 		vldr.32	s14, .L82+128
 1378 02b8 87EE870A 		vdiv.f32	s0, s15, s14
 321:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 1379              		.loc 1 321 53 view .LVU295
 1380 02bc DFED337A 		vldr.32	s15, .L82+132
 1381 02c0 20EE270A 		vmul.f32	s0, s0, s15
 1382 02c4 FFF7FEFF 		bl	arm_cos_f32
 1383              	.LVL110:
 321:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 1384              		.loc 1 321 51 view .LVU296
 1385 02c8 314B     		ldr	r3, .L82+136
 1386 02ca D3ED007A 		vldr.32	s15, [r3]
 1387 02ce 60EE277A 		vmul.f32	s15, s0, s15
 321:Src/foc.c     ****                 //send_wave(duty*1000,(Position_Degree-Position_Offset-Phi),Position_Degree,Speed/5
 1388              		.loc 1 321 40 view .LVU297
 1389 02d2 304B     		ldr	r3, .L82+140
 1390 02d4 D3ED000A 		vldr.32	s1, [r3]
 1391              	.LVL111:
 323:Src/foc.c     ****             }
 1392              		.loc 1 323 17 is_stmt 1 view .LVU298
 1393 02d8 214B     		ldr	r3, .L82+88
 1394 02da 93ED000A 		vldr.32	s0, [r3]
 1395 02de 77EEA00A 		vadd.f32	s1, s15, s1
 1396              	.LVL112:
 323:Src/foc.c     ****             }
 1397              		.loc 1 323 17 is_stmt 0 view .LVU299
 1398 02e2 DFED2D7A 		vldr.32	s15, .L82+144
 1399 02e6 30EE270A 		vadd.f32	s0, s0, s15
 1400 02ea FFF7FEFF 		bl	SVPWM
 1401              	.LVL113:
 323:Src/foc.c     ****             }
 1402              		.loc 1 323 17 view .LVU300
 1403 02ee ABE7     		b	.L70
 1404              	.L68:
 323:Src/foc.c     ****             }
 1405              		.loc 1 323 17 view .LVU301
 1406              	.LBE28:
 326:Src/foc.c     ****                 FOC_STOP();
 1407              		.loc 1 326 13 is_stmt 1 view .LVU302
 326:Src/foc.c     ****                 FOC_STOP();
 1408              		.loc 1 326 26 is_stmt 0 view .LVU303
 1409 02f0 094B     		ldr	r3, .L82+16
 1410 02f2 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 326:Src/foc.c     ****                 FOC_STOP();
 1411              		.loc 1 326 15 view .LVU304
 1412 02f4 032B     		cmp	r3, #3
 1413 02f6 A7D0     		beq	.L70
 327:Src/foc.c     ****         }
 1414              		.loc 1 327 17 is_stmt 1 view .LVU305
 1415 02f8 1F4B     		ldr	r3, .L82+112
 1416 02fa 9FED200A 		vldr.32	s0, .L82+116
 1417 02fe 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1418 0300 FFF7FEFF 		bl	Set_Vector
 1419              	.LVL114:
 1420 0304 A0E7     		b	.L70
 1421              	.L83:
 1422 0306 00BF     		.align	3
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 39


 1423              	.L82:
 1424 0308 9A999999 		.word	-1717986918
 1425 030c 9999B93F 		.word	1069128089
 1426 0310 00200140 		.word	1073815552
 1427 0314 00000000 		.word	.LANCHOR11
 1428 0318 00000000 		.word	.LANCHOR12
 1429 031c 00000000 		.word	.LANCHOR13
 1430 0320 00080240 		.word	1073874944
 1431 0324 00000000 		.word	.LANCHOR14
 1432 0328 00000000 		.word	.LANCHOR7
 1433 032c 00000000 		.word	.LANCHOR8
 1434 0330 00008039 		.word	964689920
 1435 0334 33335340 		.word	1079194419
 1436 0338 00004842 		.word	1112014848
 1437 033c A69B443B 		.word	994352038
 1438 0340 00D8D647 		.word	1205262336
 1439 0344 00401C46 		.word	1176256512
 1440 0348 00000000 		.word	.LANCHOR15
 1441 034c 00000000 		.word	ibeta
 1442 0350 00000000 		.word	ialpha
 1443 0354 00000000 		.word	Position
 1444 0358 00000000 		.word	Position_Degree
 1445 035c 00000000 		.word	.LANCHOR9
 1446 0360 00000000 		.word	Position_Phase_Degree
 1447 0364 00000000 		.word	iq
 1448 0368 00000000 		.word	id
 1449 036c 00000000 		.word	.LANCHOR16
 1450 0370 00000000 		.word	wg1
 1451 0374 00000000 		.word	wg2
 1452 0378 00000000 		.word	U0
 1453 037c CDCCCC3D 		.word	1036831949
 1454 0380 00000000 		.word	.LANCHOR17
 1455 0384 00000000 		.word	.LANCHOR18
 1456 0388 00003443 		.word	1127481344
 1457 038c DA0F4940 		.word	1078530010
 1458 0390 00000000 		.word	.LANCHOR19
 1459 0394 00000000 		.word	.LANCHOR20
 1460 0398 0000B442 		.word	1119092736
 1461              		.cfi_endproc
 1462              	.LFE173:
 1464              		.section	.rodata.Test_Direction.str1.4,"aMS",%progbits,1
 1465              		.align	2
 1466              	.LC1:
 1467 0000 74686520 		.ascii	"the test result is :%d \015\012\000"
 1467      74657374 
 1467      20726573 
 1467      756C7420 
 1467      6973203A 
 1468              		.section	.text.Test_Direction,"ax",%progbits
 1469              		.align	1
 1470              		.global	Test_Direction
 1471              		.syntax unified
 1472              		.thumb
 1473              		.thumb_func
 1474              		.fpu fpv4-sp-d16
 1476              	Test_Direction:
 1477              	.LFB174:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 40


 346:Src/foc.c     ****     uint16_t last_pos=Position;
 1478              		.loc 1 346 22 view -0
 1479              		.cfi_startproc
 1480              		@ args = 0, pretend = 0, frame = 0
 1481              		@ frame_needed = 0, uses_anonymous_args = 0
 1482 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 1483              	.LCFI31:
 1484              		.cfi_def_cfa_offset 24
 1485              		.cfi_offset 3, -24
 1486              		.cfi_offset 4, -20
 1487              		.cfi_offset 5, -16
 1488              		.cfi_offset 6, -12
 1489              		.cfi_offset 7, -8
 1490              		.cfi_offset 14, -4
 347:Src/foc.c     ****     Mode old_mode;
 1491              		.loc 1 347 5 view .LVU307
 347:Src/foc.c     ****     Mode old_mode;
 1492              		.loc 1 347 14 is_stmt 0 view .LVU308
 1493 0002 224B     		ldr	r3, .L93
 1494 0004 1D88     		ldrh	r5, [r3]
 1495              	.LVL115:
 348:Src/foc.c     ****     int result=0;
 1496              		.loc 1 348 5 is_stmt 1 view .LVU309
 349:Src/foc.c     **** 
 1497              		.loc 1 349 5 view .LVU310
 351:Src/foc.c     ****     Board_Mode = TEST;
 1498              		.loc 1 351 5 view .LVU311
 351:Src/foc.c     ****     Board_Mode = TEST;
 1499              		.loc 1 351 14 is_stmt 0 view .LVU312
 1500 0006 224B     		ldr	r3, .L93+4
 1501 0008 1F78     		ldrb	r7, [r3]	@ zero_extendqisi2
 1502              	.LVL116:
 352:Src/foc.c     ****     for(int i=0;i<1000;++i){
 1503              		.loc 1 352 5 is_stmt 1 view .LVU313
 352:Src/foc.c     ****     for(int i=0;i<1000;++i){
 1504              		.loc 1 352 16 is_stmt 0 view .LVU314
 1505 000a 0322     		movs	r2, #3
 1506 000c 1A70     		strb	r2, [r3]
 353:Src/foc.c     ****         SVPWM(i%360,0.1);
 1507              		.loc 1 353 5 is_stmt 1 view .LVU315
 1508              	.LBB29:
 353:Src/foc.c     ****         SVPWM(i%360,0.1);
 1509              		.loc 1 353 9 view .LVU316
 1510              	.LVL117:
 353:Src/foc.c     ****         SVPWM(i%360,0.1);
 1511              		.loc 1 353 13 is_stmt 0 view .LVU317
 1512 000e 0024     		movs	r4, #0
 1513              	.LBE29:
 349:Src/foc.c     **** 
 1514              		.loc 1 349 9 view .LVU318
 1515 0010 2646     		mov	r6, r4
 1516              	.LBB30:
 353:Src/foc.c     ****         SVPWM(i%360,0.1);
 1517              		.loc 1 353 5 view .LVU319
 1518 0012 04E0     		b	.L85
 1519              	.LVL118:
 1520              	.L86:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 41


 362:Src/foc.c     ****             result--;
 1521              		.loc 1 362 15 is_stmt 1 view .LVU320
 362:Src/foc.c     ****             result--;
 1522              		.loc 1 362 17 is_stmt 0 view .LVU321
 1523 0014 AB42     		cmp	r3, r5
 1524 0016 00DA     		bge	.L87
 363:Src/foc.c     ****         }
 1525              		.loc 1 363 13 is_stmt 1 view .LVU322
 363:Src/foc.c     ****         }
 1526              		.loc 1 363 19 is_stmt 0 view .LVU323
 1527 0018 013E     		subs	r6, r6, #1
 1528              	.LVL119:
 1529              	.L87:
 365:Src/foc.c     ****     }
 1530              		.loc 1 365 9 is_stmt 1 discriminator 2 view .LVU324
 365:Src/foc.c     ****     }
 1531              		.loc 1 365 17 is_stmt 0 discriminator 2 view .LVU325
 1532 001a 9DB2     		uxth	r5, r3
 1533              	.LVL120:
 353:Src/foc.c     ****         SVPWM(i%360,0.1);
 1534              		.loc 1 353 24 is_stmt 1 discriminator 2 view .LVU326
 1535 001c 0134     		adds	r4, r4, #1
 1536              	.LVL121:
 1537              	.L85:
 353:Src/foc.c     ****         SVPWM(i%360,0.1);
 1538              		.loc 1 353 17 discriminator 1 view .LVU327
 353:Src/foc.c     ****         SVPWM(i%360,0.1);
 1539              		.loc 1 353 5 is_stmt 0 discriminator 1 view .LVU328
 1540 001e B4F57A7F 		cmp	r4, #1000
 1541 0022 1CDA     		bge	.L91
 354:Src/foc.c     ****         /*
 1542              		.loc 1 354 9 is_stmt 1 view .LVU329
 354:Src/foc.c     ****         /*
 1543              		.loc 1 354 16 is_stmt 0 view .LVU330
 1544 0024 1B4B     		ldr	r3, .L93+8
 1545 0026 83FB0423 		smull	r2, r3, r3, r4
 1546 002a 1A19     		adds	r2, r3, r4
 1547 002c E317     		asrs	r3, r4, #31
 1548 002e C3EB2223 		rsb	r3, r3, r2, asr #8
 1549 0032 4FF4B472 		mov	r2, #360
 1550 0036 02FB1343 		mls	r3, r2, r3, r4
 354:Src/foc.c     ****         /*
 1551              		.loc 1 354 9 view .LVU331
 1552 003a DFED170A 		vldr.32	s1, .L93+12
 1553 003e 07EE903A 		vmov	s15, r3	@ int
 1554 0042 B8EEE70A 		vcvt.f32.s32	s0, s15
 1555 0046 FFF7FEFF 		bl	SVPWM
 1556              	.LVL122:
 359:Src/foc.c     ****         if(Position>last_pos){
 1557              		.loc 1 359 9 is_stmt 1 view .LVU332
 1558 004a 0120     		movs	r0, #1
 1559 004c FFF7FEFF 		bl	HAL_Delay
 1560              	.LVL123:
 360:Src/foc.c     ****             result++;
 1561              		.loc 1 360 9 view .LVU333
 360:Src/foc.c     ****             result++;
 1562              		.loc 1 360 20 is_stmt 0 view .LVU334
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 42


 1563 0050 0E4B     		ldr	r3, .L93
 1564 0052 B3F90030 		ldrsh	r3, [r3]
 360:Src/foc.c     ****             result++;
 1565              		.loc 1 360 11 view .LVU335
 1566 0056 AB42     		cmp	r3, r5
 1567 0058 DCDD     		ble	.L86
 361:Src/foc.c     ****         }else if(Position<last_pos){
 1568              		.loc 1 361 13 is_stmt 1 view .LVU336
 361:Src/foc.c     ****         }else if(Position<last_pos){
 1569              		.loc 1 361 19 is_stmt 0 view .LVU337
 1570 005a 0136     		adds	r6, r6, #1
 1571              	.LVL124:
 361:Src/foc.c     ****         }else if(Position<last_pos){
 1572              		.loc 1 361 19 view .LVU338
 1573 005c DDE7     		b	.L87
 1574              	.L91:
 361:Src/foc.c     ****         }else if(Position<last_pos){
 1575              		.loc 1 361 19 view .LVU339
 1576              	.LBE30:
 367:Src/foc.c     ****     uprintf_polling("the test result is :%d \r\n",result);
 1577              		.loc 1 367 5 is_stmt 1 view .LVU340
 1578 005e 0F4B     		ldr	r3, .L93+16
 1579 0060 9FED0D0A 		vldr.32	s0, .L93+12
 1580 0064 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1581 0066 FFF7FEFF 		bl	Set_Vector
 1582              	.LVL125:
 368:Src/foc.c     ****     if(result<0){
 1583              		.loc 1 368 5 view .LVU341
 1584 006a 3146     		mov	r1, r6
 1585 006c 0C48     		ldr	r0, .L93+20
 1586 006e FFF7FEFF 		bl	uprintf_polling
 1587              	.LVL126:
 369:Src/foc.c     ****         Motor.Encoder_Direction=!Motor.Encoder_Direction;
 1588              		.loc 1 369 5 view .LVU342
 369:Src/foc.c     ****         Motor.Encoder_Direction=!Motor.Encoder_Direction;
 1589              		.loc 1 369 7 is_stmt 0 view .LVU343
 1590 0072 002E     		cmp	r6, #0
 1591 0074 02DB     		blt	.L92
 1592              	.L89:
 373:Src/foc.c     **** }
 1593              		.loc 1 373 5 is_stmt 1 view .LVU344
 373:Src/foc.c     **** }
 1594              		.loc 1 373 16 is_stmt 0 view .LVU345
 1595 0076 064B     		ldr	r3, .L93+4
 1596 0078 1F70     		strb	r7, [r3]
 374:Src/foc.c     **** 
 1597              		.loc 1 374 1 view .LVU346
 1598 007a F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 1599              	.LVL127:
 1600              	.L92:
 370:Src/foc.c     ****     }
 1601              		.loc 1 370 9 is_stmt 1 view .LVU347
 370:Src/foc.c     ****     }
 1602              		.loc 1 370 39 is_stmt 0 view .LVU348
 1603 007c 094A     		ldr	r2, .L93+24
 1604 007e 137A     		ldrb	r3, [r2, #8]	@ zero_extendqisi2
 370:Src/foc.c     ****     }
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 43


 1605              		.loc 1 370 33 view .LVU349
 1606 0080 B3FA83F3 		clz	r3, r3
 1607 0084 5B09     		lsrs	r3, r3, #5
 370:Src/foc.c     ****     }
 1608              		.loc 1 370 32 view .LVU350
 1609 0086 1372     		strb	r3, [r2, #8]
 1610 0088 F5E7     		b	.L89
 1611              	.L94:
 1612 008a 00BF     		.align	2
 1613              	.L93:
 1614 008c 00000000 		.word	Position
 1615 0090 00000000 		.word	.LANCHOR12
 1616 0094 B7600BB6 		.word	-1240768329
 1617 0098 CDCCCC3D 		.word	1036831949
 1618 009c 00000000 		.word	U0
 1619 00a0 00000000 		.word	.LC1
 1620 00a4 00000000 		.word	.LANCHOR9
 1621              		.cfi_endproc
 1622              	.LFE174:
 1624              		.section	.text.Measure_Res,"ax",%progbits
 1625              		.align	1
 1626              		.global	Measure_Res
 1627              		.syntax unified
 1628              		.thumb
 1629              		.thumb_func
 1630              		.fpu fpv4-sp-d16
 1632              	Measure_Res:
 1633              	.LFB175:
 376:Src/foc.c     ****     Mode old_mode;
 1634              		.loc 1 376 19 is_stmt 1 view -0
 1635              		.cfi_startproc
 1636              		@ args = 0, pretend = 0, frame = 0
 1637              		@ frame_needed = 0, uses_anonymous_args = 0
 1638 0000 08B5     		push	{r3, lr}
 1639              	.LCFI32:
 1640              		.cfi_def_cfa_offset 8
 1641              		.cfi_offset 3, -8
 1642              		.cfi_offset 14, -4
 377:Src/foc.c     ****     old_mode = Board_Mode;
 1643              		.loc 1 377 5 view .LVU352
 378:Src/foc.c     ****     Board_Mode = TEST; 
 1644              		.loc 1 378 5 view .LVU353
 1645              	.LVL128:
 379:Src/foc.c     **** 
 1646              		.loc 1 379 5 view .LVU354
 379:Src/foc.c     **** 
 1647              		.loc 1 379 16 is_stmt 0 view .LVU355
 1648 0002 054B     		ldr	r3, .L97
 1649 0004 0322     		movs	r2, #3
 1650 0006 1A70     		strb	r2, [r3]
 1651              	.LVL129:
 381:Src/foc.c     **** }
 1652              		.loc 1 381 5 is_stmt 1 view .LVU356
 1653 0008 044B     		ldr	r3, .L97+4
 1654 000a 9FED050A 		vldr.32	s0, .L97+8
 1655 000e 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1656 0010 FFF7FEFF 		bl	Set_Vector
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 44


 1657              	.LVL130:
 382:Src/foc.c     **** 
 1658              		.loc 1 382 1 is_stmt 0 view .LVU357
 1659 0014 08BD     		pop	{r3, pc}
 1660              	.L98:
 1661 0016 00BF     		.align	2
 1662              	.L97:
 1663 0018 00000000 		.word	.LANCHOR12
 1664 001c 00000000 		.word	U4
 1665 0020 CDCCCC3D 		.word	1036831949
 1666              		.cfi_endproc
 1667              	.LFE175:
 1669              		.section	.rodata.Detect_Encoder.str1.4,"aMS",%progbits,1
 1670              		.align	2
 1671              	.LC2:
 1672 0000 706F733A 		.ascii	"pos:%d\015\012\000"
 1672      25640D0A 
 1672      00
 1673 0009 000000   		.align	2
 1674              	.LC3:
 1675 000c 726F7461 		.ascii	"rotate to syn,and the phase pos_degree is %f\015\012"
 1675      74652074 
 1675      6F207379 
 1675      6E2C616E 
 1675      64207468 
 1676 003a 00       		.ascii	"\000"
 1677 003b 00       		.align	2
 1678              	.LC4:
 1679 003c 74686520 		.ascii	"the sub is %f  sin is %f,cos is %f\015\012\000"
 1679      73756220 
 1679      69732025 
 1679      66202073 
 1679      696E2069 
 1680 0061 000000   		.align	2
 1681              	.LC5:
 1682 0064 74686520 		.ascii	"the offset is %f \015\012\000"
 1682      6F666673 
 1682      65742069 
 1682      73202566 
 1682      200D0A00 
 1683              		.align	2
 1684              	.LC6:
 1685 0078 74686520 		.ascii	"the paris %f\015\012\000"
 1685      70617269 
 1685      73202566 
 1685      0D0A00
 1686              		.section	.text.Detect_Encoder,"ax",%progbits
 1687              		.align	1
 1688              		.global	Detect_Encoder
 1689              		.syntax unified
 1690              		.thumb
 1691              		.thumb_func
 1692              		.fpu fpv4-sp-d16
 1694              	Detect_Encoder:
 1695              	.LFB177:
 391:Src/foc.c     ****     // Ê£ÄÊµãÁ£ÅÁºñÁ†ÅÂô®ÈùôÊÄÅËØØÂ∑Æ
 1696              		.loc 1 391 22 is_stmt 1 view -0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 45


 1697              		.cfi_startproc
 1698              		@ args = 0, pretend = 0, frame = 8
 1699              		@ frame_needed = 0, uses_anonymous_args = 0
 1700 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 1701              	.LCFI33:
 1702              		.cfi_def_cfa_offset 20
 1703              		.cfi_offset 4, -20
 1704              		.cfi_offset 5, -16
 1705              		.cfi_offset 6, -12
 1706              		.cfi_offset 7, -8
 1707              		.cfi_offset 14, -4
 1708 0002 2DED088B 		vpush.64	{d8, d9, d10, d11}
 1709              	.LCFI34:
 1710              		.cfi_def_cfa_offset 52
 1711              		.cfi_offset 80, -52
 1712              		.cfi_offset 81, -48
 1713              		.cfi_offset 82, -44
 1714              		.cfi_offset 83, -40
 1715              		.cfi_offset 84, -36
 1716              		.cfi_offset 85, -32
 1717              		.cfi_offset 86, -28
 1718              		.cfi_offset 87, -24
 1719 0006 87B0     		sub	sp, sp, #28
 1720              	.LCFI35:
 1721              		.cfi_def_cfa_offset 80
 394:Src/foc.c     ****     float last_position=0;
 1722              		.loc 1 394 5 view .LVU359
 395:Src/foc.c     ****     float m_sub = 0; // Êú∫Ê¢∞ËßíÂ∫¶ËΩ¨Ëøá‰∫ÜÂ§öÂ∞ë
 1723              		.loc 1 395 5 view .LVU360
 1724              	.LVL131:
 396:Src/foc.c     ****     Mode old_mode;
 1725              		.loc 1 396 5 view .LVU361
 397:Src/foc.c     **** 
 1726              		.loc 1 397 5 view .LVU362
 399:Src/foc.c     ****     Board_Mode = TEST;
 1727              		.loc 1 399 5 view .LVU363
 399:Src/foc.c     ****     Board_Mode = TEST;
 1728              		.loc 1 399 14 is_stmt 0 view .LVU364
 1729 0008 6E4B     		ldr	r3, .L116
 1730 000a 1D78     		ldrb	r5, [r3]	@ zero_extendqisi2
 1731              	.LVL132:
 400:Src/foc.c     **** 
 1732              		.loc 1 400 5 is_stmt 1 view .LVU365
 400:Src/foc.c     **** 
 1733              		.loc 1 400 16 is_stmt 0 view .LVU366
 1734 000c 0322     		movs	r2, #3
 1735 000e 1A70     		strb	r2, [r3]
 402:Src/foc.c     ****     Motor.Position_Phase_Offset = 0;
 1736              		.loc 1 402 5 is_stmt 1 view .LVU367
 1737              	.LVL133:
 403:Src/foc.c     ****     for(int i =0; i<1000;++i){
 1738              		.loc 1 403 5 view .LVU368
 403:Src/foc.c     ****     for(int i =0; i<1000;++i){
 1739              		.loc 1 403 33 is_stmt 0 view .LVU369
 1740 0010 6D4B     		ldr	r3, .L116+4
 1741 0012 0022     		movs	r2, #0
 1742 0014 5A60     		str	r2, [r3, #4]	@ float
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 46


 404:Src/foc.c     ****         HAL_Delay(1);
 1743              		.loc 1 404 5 is_stmt 1 view .LVU370
 1744              	.LBB31:
 404:Src/foc.c     ****         HAL_Delay(1);
 1745              		.loc 1 404 9 view .LVU371
 1746              	.LVL134:
 404:Src/foc.c     ****         HAL_Delay(1);
 1747              		.loc 1 404 13 is_stmt 0 view .LVU372
 1748 0016 0024     		movs	r4, #0
 1749              	.LVL135:
 1750              	.L100:
 404:Src/foc.c     ****         HAL_Delay(1);
 1751              		.loc 1 404 19 is_stmt 1 discriminator 1 view .LVU373
 404:Src/foc.c     ****         HAL_Delay(1);
 1752              		.loc 1 404 5 is_stmt 0 discriminator 1 view .LVU374
 1753 0018 B4F57A7F 		cmp	r4, #1000
 1754 001c 0ADA     		bge	.L112
 405:Src/foc.c     ****         uprintf_polling("pos:%d\r\n",Position);
 1755              		.loc 1 405 9 is_stmt 1 discriminator 3 view .LVU375
 1756 001e 0120     		movs	r0, #1
 1757 0020 FFF7FEFF 		bl	HAL_Delay
 1758              	.LVL136:
 406:Src/foc.c     ****     }
 1759              		.loc 1 406 9 discriminator 3 view .LVU376
 1760 0024 694B     		ldr	r3, .L116+8
 1761 0026 B3F90010 		ldrsh	r1, [r3]
 1762 002a 6948     		ldr	r0, .L116+12
 1763 002c FFF7FEFF 		bl	uprintf_polling
 1764              	.LVL137:
 404:Src/foc.c     ****         HAL_Delay(1);
 1765              		.loc 1 404 26 discriminator 3 view .LVU377
 1766 0030 0134     		adds	r4, r4, #1
 1767              	.LVL138:
 404:Src/foc.c     ****         HAL_Delay(1);
 1768              		.loc 1 404 26 is_stmt 0 discriminator 3 view .LVU378
 1769 0032 F1E7     		b	.L100
 1770              	.L112:
 404:Src/foc.c     ****         HAL_Delay(1);
 1771              		.loc 1 404 26 discriminator 3 view .LVU379
 1772              	.LBE31:
 1773              	.LBB32:
 1774              	.LBB33:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1775              		.loc 1 385 15 view .LVU380
 1776 0034 9FED678A 		vldr.32	s16, .L116+16
 1777 0038 0CE0     		b	.L102
 1778              	.LVL139:
 1779              	.L103:
 386:Src/foc.c     ****         HAL_Delay(1);
 1780              		.loc 1 386 9 is_stmt 1 view .LVU381
 1781 003a DFED670A 		vldr.32	s1, .L116+20
 1782 003e B0EE480A 		vmov.f32	s0, s16
 1783 0042 FFF7FEFF 		bl	SVPWM
 1784              	.LVL140:
 387:Src/foc.c     ****     }
 1785              		.loc 1 387 9 view .LVU382
 1786 0046 0120     		movs	r0, #1
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 47


 1787 0048 FFF7FEFF 		bl	HAL_Delay
 1788              	.LVL141:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1789              		.loc 1 385 40 view .LVU383
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1790              		.loc 1 385 45 is_stmt 0 view .LVU384
 1791 004c DFED637A 		vldr.32	s15, .L116+24
 1792 0050 38EE278A 		vadd.f32	s16, s16, s15
 1793              	.LVL142:
 1794              	.L102:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1795              		.loc 1 385 29 is_stmt 1 view .LVU385
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1796              		.loc 1 385 5 is_stmt 0 view .LVU386
 1797 0054 DFED627A 		vldr.32	s15, .L116+28
 1798 0058 B4EEE78A 		vcmpe.f32	s16, s15
 1799 005c F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1800 0060 EBD4     		bmi	.L103
 1801              	.LVL143:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1802              		.loc 1 385 5 view .LVU387
 1803              	.LBE33:
 1804              	.LBE32:
 409:Src/foc.c     ****     HAL_Delay(10);
 1805              		.loc 1 409 5 is_stmt 1 view .LVU388
 1806 0062 604B     		ldr	r3, .L116+32
 1807 0064 9FED5C0A 		vldr.32	s0, .L116+20
 1808 0068 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1809 006a FFF7FEFF 		bl	Set_Vector
 1810              	.LVL144:
 410:Src/foc.c     ****     uprintf_polling("rotate to syn,and the phase pos_degree is %f\r\n",Position_Phase_Degree);
 1811              		.loc 1 410 5 view .LVU389
 1812 006e 0A20     		movs	r0, #10
 1813 0070 FFF7FEFF 		bl	HAL_Delay
 1814              	.LVL145:
 411:Src/foc.c     ****     last_position = Position_Degree;
 1815              		.loc 1 411 5 view .LVU390
 1816 0074 5C4B     		ldr	r3, .L116+36
 1817 0076 1868     		ldr	r0, [r3]	@ float
 1818 0078 FFF7FEFF 		bl	__aeabi_f2d
 1819              	.LVL146:
 1820 007c 0246     		mov	r2, r0
 1821 007e 0B46     		mov	r3, r1
 1822 0080 5A48     		ldr	r0, .L116+40
 1823 0082 FFF7FEFF 		bl	uprintf_polling
 1824              	.LVL147:
 412:Src/foc.c     ****     for(int i=0;i<21;++i){  // 3‰∏™‰∏ÄÂúàÁîµËßíÂ∫¶Ôºå21‰∏™‰∏ÄÂúàÊú∫Ê¢∞ËßíÂ∫¶
 1825              		.loc 1 412 5 view .LVU391
 412:Src/foc.c     ****     for(int i=0;i<21;++i){  // 3‰∏™‰∏ÄÂúàÁîµËßíÂ∫¶Ôºå21‰∏™‰∏ÄÂúàÊú∫Ê¢∞ËßíÂ∫¶
 1826              		.loc 1 412 19 is_stmt 0 view .LVU392
 1827 0086 5A4B     		ldr	r3, .L116+44
 1828 0088 93ED009A 		vldr.32	s18, [r3]
 1829              	.LVL148:
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 1830              		.loc 1 413 5 is_stmt 1 view .LVU393
 1831              	.LBB34:
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 48


 1832              		.loc 1 413 9 view .LVU394
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 1833              		.loc 1 413 13 is_stmt 0 view .LVU395
 1834 008c 0024     		movs	r4, #0
 1835              	.LVL149:
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 1836              		.loc 1 413 13 view .LVU396
 1837              	.LBE34:
 396:Src/foc.c     ****     Mode old_mode;
 1838              		.loc 1 396 11 view .LVU397
 1839 008e 9FED51AA 		vldr.32	s20, .L116+16
 402:Src/foc.c     ****     Motor.Position_Phase_Offset = 0;
 1840              		.loc 1 402 20 view .LVU398
 1841 0092 B0EE4ABA 		vmov.f32	s22, s20
 402:Src/foc.c     ****     Motor.Position_Phase_Offset = 0;
 1842              		.loc 1 402 12 view .LVU399
 1843 0096 F0EE4AAA 		vmov.f32	s21, s20
 1844              	.LBB42:
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 1845              		.loc 1 413 5 view .LVU400
 1846 009a 37E0     		b	.L104
 1847              	.LVL150:
 1848              	.L115:
 1849              	.LBB35:
 415:Src/foc.c     ****         float off_temp = Position_Phase_Degree - (i+1)*120;
 1850              		.loc 1 415 9 is_stmt 1 view .LVU401
 416:Src/foc.c     ****         arm_sin_cos_f32(off_temp,&sin,&cos);
 1851              		.loc 1 416 9 view .LVU402
 416:Src/foc.c     ****         arm_sin_cos_f32(off_temp,&sin,&cos);
 1852              		.loc 1 416 48 is_stmt 0 view .LVU403
 1853 009c 524B     		ldr	r3, .L116+36
 1854 009e D3ED007A 		vldr.32	s15, [r3]
 416:Src/foc.c     ****         arm_sin_cos_f32(off_temp,&sin,&cos);
 1855              		.loc 1 416 15 view .LVU404
 1856 00a2 77EEE88A 		vsub.f32	s17, s15, s17
 1857              	.LVL151:
 417:Src/foc.c     ****         sin_sum+=sin;
 1858              		.loc 1 417 9 is_stmt 1 view .LVU405
 1859 00a6 05A9     		add	r1, sp, #20
 1860 00a8 04A8     		add	r0, sp, #16
 1861 00aa B0EE680A 		vmov.f32	s0, s17
 1862 00ae FFF7FEFF 		bl	arm_sin_cos_f32
 1863              	.LVL152:
 418:Src/foc.c     ****         cos_sum+=cos;
 1864              		.loc 1 418 9 view .LVU406
 418:Src/foc.c     ****         cos_sum+=cos;
 1865              		.loc 1 418 16 is_stmt 0 view .LVU407
 1866 00b2 9DED048A 		vldr.32	s16, [sp, #16]
 1867 00b6 7AEE88AA 		vadd.f32	s21, s21, s16
 1868              	.LVL153:
 419:Src/foc.c     ****         uprintf_polling("the sub is %f  sin is %f,cos is %f\r\n",off_temp,sin,cos);
 1869              		.loc 1 419 9 is_stmt 1 view .LVU408
 419:Src/foc.c     ****         uprintf_polling("the sub is %f  sin is %f,cos is %f\r\n",off_temp,sin,cos);
 1870              		.loc 1 419 16 is_stmt 0 view .LVU409
 1871 00ba DDED059A 		vldr.32	s19, [sp, #20]
 1872 00be 3BEE29BA 		vadd.f32	s22, s22, s19
 1873              	.LVL154:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 49


 420:Src/foc.c     **** 
 1874              		.loc 1 420 9 is_stmt 1 view .LVU410
 1875 00c2 18EE900A 		vmov	r0, s17
 1876 00c6 FFF7FEFF 		bl	__aeabi_f2d
 1877              	.LVL155:
 1878 00ca 0646     		mov	r6, r0
 1879 00cc 0F46     		mov	r7, r1
 1880 00ce 19EE900A 		vmov	r0, s19
 1881 00d2 FFF7FEFF 		bl	__aeabi_f2d
 1882              	.LVL156:
 1883 00d6 CDE90201 		strd	r0, [sp, #8]
 1884 00da 18EE100A 		vmov	r0, s16
 1885 00de FFF7FEFF 		bl	__aeabi_f2d
 1886              	.LVL157:
 1887 00e2 CDE90001 		strd	r0, [sp]
 1888 00e6 3246     		mov	r2, r6
 1889 00e8 3B46     		mov	r3, r7
 1890 00ea 4248     		ldr	r0, .L116+48
 1891 00ec FFF7FEFF 		bl	uprintf_polling
 1892              	.LVL158:
 422:Src/foc.c     ****         if(tmp<0){
 1893              		.loc 1 422 9 view .LVU411
 422:Src/foc.c     ****         if(tmp<0){
 1894              		.loc 1 422 35 is_stmt 0 view .LVU412
 1895 00f0 3F4B     		ldr	r3, .L116+44
 1896 00f2 93ED007A 		vldr.32	s14, [r3]
 422:Src/foc.c     ****         if(tmp<0){
 1897              		.loc 1 422 15 view .LVU413
 1898 00f6 77EE497A 		vsub.f32	s15, s14, s18
 1899              	.LVL159:
 423:Src/foc.c     ****             tmp+=360;
 1900              		.loc 1 423 9 is_stmt 1 view .LVU414
 423:Src/foc.c     ****             tmp+=360;
 1901              		.loc 1 423 11 is_stmt 0 view .LVU415
 1902 00fa F5EEC07A 		vcmpe.f32	s15, #0
 1903 00fe F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1904 0102 27D4     		bmi	.L113
 1905              	.L107:
 426:Src/foc.c     ****         last_position =  Position_Degree;
 1906              		.loc 1 426 9 is_stmt 1 discriminator 2 view .LVU416
 426:Src/foc.c     ****         last_position =  Position_Degree;
 1907              		.loc 1 426 14 is_stmt 0 discriminator 2 view .LVU417
 1908 0104 3AEE27AA 		vadd.f32	s20, s20, s15
 1909              	.LVL160:
 427:Src/foc.c     ****     }
 1910              		.loc 1 427 9 is_stmt 1 discriminator 2 view .LVU418
 427:Src/foc.c     ****     }
 1911              		.loc 1 427 9 is_stmt 0 discriminator 2 view .LVU419
 1912              	.LBE35:
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 1913              		.loc 1 413 22 is_stmt 1 discriminator 2 view .LVU420
 1914              	.LBB39:
 427:Src/foc.c     ****     }
 1915              		.loc 1 427 23 is_stmt 0 discriminator 2 view .LVU421
 1916 0108 B0EE479A 		vmov.f32	s18, s14
 1917              	.LVL161:
 1918              	.L104:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 50


 427:Src/foc.c     ****     }
 1919              		.loc 1 427 23 discriminator 2 view .LVU422
 1920              	.LBE39:
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 1921              		.loc 1 413 17 is_stmt 1 discriminator 1 view .LVU423
 413:Src/foc.c     ****         Rotate_Phase(i*120,(i+1)*120,120/500.0f);
 1922              		.loc 1 413 5 is_stmt 0 discriminator 1 view .LVU424
 1923 010c 142C     		cmp	r4, #20
 1924 010e 26DC     		bgt	.L114
 1925              	.LBB40:
 414:Src/foc.c     ****         float sin,cos;
 1926              		.loc 1 414 9 is_stmt 1 view .LVU425
 414:Src/foc.c     ****         float sin,cos;
 1927              		.loc 1 414 23 is_stmt 0 view .LVU426
 1928 0110 C4EB0413 		rsb	r3, r4, r4, lsl #4
 1929 0114 DB00     		lsls	r3, r3, #3
 414:Src/foc.c     ****         float sin,cos;
 1930              		.loc 1 414 9 view .LVU427
 1931 0116 07EE903A 		vmov	s15, r3	@ int
 1932 011a B8EEE78A 		vcvt.f32.s32	s16, s15
 414:Src/foc.c     ****         float sin,cos;
 1933              		.loc 1 414 30 view .LVU428
 1934 011e 0134     		adds	r4, r4, #1
 1935              	.LVL162:
 414:Src/foc.c     ****         float sin,cos;
 1936              		.loc 1 414 33 view .LVU429
 1937 0120 C4EB0413 		rsb	r3, r4, r4, lsl #4
 1938 0124 DB00     		lsls	r3, r3, #3
 414:Src/foc.c     ****         float sin,cos;
 1939              		.loc 1 414 9 view .LVU430
 1940 0126 07EE903A 		vmov	s15, r3	@ int
 1941 012a F8EEE78A 		vcvt.f32.s32	s17, s15
 1942              	.LVL163:
 1943              	.LBB36:
 1944              	.LBI36:
 384:Src/foc.c     ****     for(float phase = start;phase<stop;phase+=step){
 1945              		.loc 1 384 13 is_stmt 1 view .LVU431
 1946              	.LBE36:
 1947              	.LBE40:
 1948              	.LBE42:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1949              		.loc 1 385 5 view .LVU432
 1950              	.LBB43:
 1951              	.LBB41:
 1952              	.LBB38:
 1953              	.LBB37:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1954              		.loc 1 385 9 view .LVU433
 1955              	.L105:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1956              		.loc 1 385 29 view .LVU434
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1957              		.loc 1 385 5 is_stmt 0 view .LVU435
 1958 012e F4EEC88A 		vcmpe.f32	s17, s16
 1959 0132 F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 1960 0136 B1DD     		ble	.L115
 386:Src/foc.c     ****         HAL_Delay(1);
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 51


 1961              		.loc 1 386 9 is_stmt 1 view .LVU436
 1962 0138 DFED270A 		vldr.32	s1, .L116+20
 1963 013c B0EE480A 		vmov.f32	s0, s16
 1964 0140 FFF7FEFF 		bl	SVPWM
 1965              	.LVL164:
 387:Src/foc.c     ****     }
 1966              		.loc 1 387 9 view .LVU437
 1967 0144 0120     		movs	r0, #1
 1968 0146 FFF7FEFF 		bl	HAL_Delay
 1969              	.LVL165:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1970              		.loc 1 385 40 view .LVU438
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1971              		.loc 1 385 45 is_stmt 0 view .LVU439
 1972 014a DFED2B7A 		vldr.32	s15, .L116+52
 1973 014e 38EE278A 		vadd.f32	s16, s16, s15
 1974              	.LVL166:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1975              		.loc 1 385 45 view .LVU440
 1976 0152 ECE7     		b	.L105
 1977              	.LVL167:
 1978              	.L113:
 385:Src/foc.c     ****         SVPWM(phase,0.1f);
 1979              		.loc 1 385 45 view .LVU441
 1980              	.LBE37:
 1981              	.LBE38:
 424:Src/foc.c     ****         }
 1982              		.loc 1 424 13 is_stmt 1 view .LVU442
 424:Src/foc.c     ****         }
 1983              		.loc 1 424 16 is_stmt 0 view .LVU443
 1984 0154 DFED226A 		vldr.32	s13, .L116+28
 1985 0158 77EEA67A 		vadd.f32	s15, s15, s13
 1986              	.LVL168:
 424:Src/foc.c     ****         }
 1987              		.loc 1 424 16 view .LVU444
 1988 015c D2E7     		b	.L107
 1989              	.LVL169:
 1990              	.L114:
 424:Src/foc.c     ****         }
 1991              		.loc 1 424 16 view .LVU445
 1992              	.LBE41:
 1993              	.LBE43:
 429:Src/foc.c     ****     Motor.Position_Phase_Offset=atan2f(sin_sum,cos_sum)*180/3.1415926f;
 1994              		.loc 1 429 5 is_stmt 1 view .LVU446
 1995 015e 214B     		ldr	r3, .L116+32
 1996 0160 9FED1D0A 		vldr.32	s0, .L116+20
 1997 0164 0FCB     		ldm	r3, {r0, r1, r2, r3}
 1998 0166 FFF7FEFF 		bl	Set_Vector
 1999              	.LVL170:
 430:Src/foc.c     ****     uprintf_polling("the offset is %f \r\n",Motor.Position_Phase_Offset);
 2000              		.loc 1 430 5 view .LVU447
 430:Src/foc.c     ****     uprintf_polling("the offset is %f \r\n",Motor.Position_Phase_Offset);
 2001              		.loc 1 430 33 is_stmt 0 view .LVU448
 2002 016a F0EE4B0A 		vmov.f32	s1, s22
 2003 016e B0EE6A0A 		vmov.f32	s0, s21
 2004 0172 FFF7FEFF 		bl	atan2f
 2005              	.LVL171:
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 52


 430:Src/foc.c     ****     uprintf_polling("the offset is %f \r\n",Motor.Position_Phase_Offset);
 2006              		.loc 1 430 56 view .LVU449
 2007 0176 DFED217A 		vldr.32	s15, .L116+56
 2008 017a 60EE277A 		vmul.f32	s15, s0, s15
 430:Src/foc.c     ****     uprintf_polling("the offset is %f \r\n",Motor.Position_Phase_Offset);
 2009              		.loc 1 430 60 view .LVU450
 2010 017e DFED206A 		vldr.32	s13, .L116+60
 2011 0182 87EEA67A 		vdiv.f32	s14, s15, s13
 430:Src/foc.c     ****     uprintf_polling("the offset is %f \r\n",Motor.Position_Phase_Offset);
 2012              		.loc 1 430 32 view .LVU451
 2013 0186 104B     		ldr	r3, .L116+4
 2014 0188 83ED017A 		vstr.32	s14, [r3, #4]
 431:Src/foc.c     ****     uprintf_polling("the paris %f\r\n",120.0f*21/m_sub);
 2015              		.loc 1 431 5 is_stmt 1 view .LVU452
 2016 018c 17EE100A 		vmov	r0, s14
 2017 0190 FFF7FEFF 		bl	__aeabi_f2d
 2018              	.LVL172:
 2019 0194 0246     		mov	r2, r0
 2020 0196 0B46     		mov	r3, r1
 2021 0198 1A48     		ldr	r0, .L116+64
 2022 019a FFF7FEFF 		bl	uprintf_polling
 2023              	.LVL173:
 432:Src/foc.c     **** 
 2024              		.loc 1 432 5 view .LVU453
 2025 019e DFED1A7A 		vldr.32	s15, .L116+68
 2026 01a2 C7EE8A7A 		vdiv.f32	s15, s15, s20
 2027 01a6 17EE900A 		vmov	r0, s15
 2028 01aa FFF7FEFF 		bl	__aeabi_f2d
 2029              	.LVL174:
 2030 01ae 0246     		mov	r2, r0
 2031 01b0 0B46     		mov	r3, r1
 2032 01b2 1648     		ldr	r0, .L116+72
 2033 01b4 FFF7FEFF 		bl	uprintf_polling
 2034              	.LVL175:
 434:Src/foc.c     **** }
 2035              		.loc 1 434 5 view .LVU454
 434:Src/foc.c     **** }
 2036              		.loc 1 434 16 is_stmt 0 view .LVU455
 2037 01b8 024B     		ldr	r3, .L116
 2038 01ba 1D70     		strb	r5, [r3]
 435:Src/foc.c     **** 
 2039              		.loc 1 435 1 view .LVU456
 2040 01bc 07B0     		add	sp, sp, #28
 2041              	.LCFI36:
 2042              		.cfi_def_cfa_offset 52
 2043              		@ sp needed
 2044 01be BDEC088B 		vldm	sp!, {d8-d11}
 2045              	.LCFI37:
 2046              		.cfi_restore 86
 2047              		.cfi_restore 87
 2048              		.cfi_restore 84
 2049              		.cfi_restore 85
 2050              		.cfi_restore 82
 2051              		.cfi_restore 83
 2052              		.cfi_restore 80
 2053              		.cfi_restore 81
 2054              		.cfi_def_cfa_offset 20
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 53


 2055              	.LVL176:
 435:Src/foc.c     **** 
 2056              		.loc 1 435 1 view .LVU457
 2057 01c2 F0BD     		pop	{r4, r5, r6, r7, pc}
 2058              	.LVL177:
 2059              	.L117:
 435:Src/foc.c     **** 
 2060              		.loc 1 435 1 view .LVU458
 2061              		.align	2
 2062              	.L116:
 2063 01c4 00000000 		.word	.LANCHOR12
 2064 01c8 00000000 		.word	.LANCHOR9
 2065 01cc 00000000 		.word	Position
 2066 01d0 00000000 		.word	.LC2
 2067 01d4 00000000 		.word	0
 2068 01d8 CDCCCC3D 		.word	1036831949
 2069 01dc EC51B83E 		.word	1052266988
 2070 01e0 0000B443 		.word	1135869952
 2071 01e4 00000000 		.word	U0
 2072 01e8 00000000 		.word	Position_Phase_Degree
 2073 01ec 0C000000 		.word	.LC3
 2074 01f0 00000000 		.word	Position_Degree
 2075 01f4 3C000000 		.word	.LC4
 2076 01f8 8FC2753E 		.word	1047904911
 2077 01fc 00003443 		.word	1127481344
 2078 0200 DA0F4940 		.word	1078530010
 2079 0204 64000000 		.word	.LC5
 2080 0208 00801D45 		.word	1159561216
 2081 020c 78000000 		.word	.LC6
 2082              		.cfi_endproc
 2083              	.LFE177:
 2085              		.section	.text.Openloop_Runing,"ax",%progbits
 2086              		.align	1
 2087              		.global	Openloop_Runing
 2088              		.syntax unified
 2089              		.thumb
 2090              		.thumb_func
 2091              		.fpu fpv4-sp-d16
 2093              	Openloop_Runing:
 2094              	.LVL178:
 2095              	.LFB178:
 439:Src/foc.c     ****     static float theta = 0;
 2096              		.loc 1 439 1 is_stmt 1 view -0
 2097              		.cfi_startproc
 2098              		@ args = 0, pretend = 0, frame = 0
 2099              		@ frame_needed = 0, uses_anonymous_args = 0
 2100              		@ link register save eliminated.
 439:Src/foc.c     ****     static float theta = 0;
 2101              		.loc 1 439 1 is_stmt 0 view .LVU460
 2102 0000 07EE100A 		vmov	s14, r0	@ int
 440:Src/foc.c     ****     float delta_p = rps * Motor.Pairs * 360.0f / freq; // ÊØèÊ¨°Ë∞ÉÁî®Êú¨ÂáΩÊï∞Ë¶ÅÂ¢ûÂä†ÁöÑÂÄº
 2103              		.loc 1 440 5 is_stmt 1 view .LVU461
 441:Src/foc.c     **** 
 2104              		.loc 1 441 5 view .LVU462
 441:Src/foc.c     **** 
 2105              		.loc 1 441 32 is_stmt 0 view .LVU463
 2106 0004 184B     		ldr	r3, .L127
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 54


 2107 0006 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 2108 0008 07EE903A 		vmov	s15, r3	@ int
 441:Src/foc.c     **** 
 2109              		.loc 1 441 25 view .LVU464
 2110 000c F8EEE77A 		vcvt.f32.s32	s15, s15
 2111 0010 27EE811A 		vmul.f32	s2, s15, s2
 2112              	.LVL179:
 441:Src/foc.c     **** 
 2113              		.loc 1 441 39 view .LVU465
 2114 0014 DFED156A 		vldr.32	s13, .L127+4
 2115 0018 21EE261A 		vmul.f32	s2, s2, s13
 441:Src/foc.c     **** 
 2116              		.loc 1 441 11 view .LVU466
 2117 001c 81EE206A 		vdiv.f32	s12, s2, s1
 2118              	.LVL180:
 443:Src/foc.c     ****     if (theta > 360)
 2119              		.loc 1 443 5 is_stmt 1 view .LVU467
 443:Src/foc.c     ****     if (theta > 360)
 2120              		.loc 1 443 24 is_stmt 0 view .LVU468
 2121 0020 F8EEC77A 		vcvt.f32.s32	s15, s14
 2122 0024 67EE867A 		vmul.f32	s15, s15, s12
 443:Src/foc.c     ****     if (theta > 360)
 2123              		.loc 1 443 11 view .LVU469
 2124 0028 114B     		ldr	r3, .L127+8
 2125 002a 93ED007A 		vldr.32	s14, [r3]
 2126 002e 77EE877A 		vadd.f32	s15, s15, s14
 2127 0032 C3ED007A 		vstr.32	s15, [r3]
 444:Src/foc.c     ****     {
 2128              		.loc 1 444 5 is_stmt 1 view .LVU470
 444:Src/foc.c     ****     {
 2129              		.loc 1 444 8 is_stmt 0 view .LVU471
 2130 0036 F4EEE67A 		vcmpe.f32	s15, s13
 2131 003a F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 2132 003e 04DD     		ble	.L125
 446:Src/foc.c     ****     }
 2133              		.loc 1 446 9 is_stmt 1 view .LVU472
 446:Src/foc.c     ****     }
 2134              		.loc 1 446 15 is_stmt 0 view .LVU473
 2135 0040 77EEE67A 		vsub.f32	s15, s15, s13
 2136 0044 C3ED007A 		vstr.32	s15, [r3]
 2137 0048 7047     		bx	lr
 2138              	.L125:
 448:Src/foc.c     ****     {
 2139              		.loc 1 448 10 is_stmt 1 view .LVU474
 448:Src/foc.c     ****     {
 2140              		.loc 1 448 13 is_stmt 0 view .LVU475
 2141 004a F5EEC07A 		vcmpe.f32	s15, #0
 2142 004e F1EE10FA 		vmrs	APSR_nzcv, FPSCR
 2143 0052 00D4     		bmi	.L126
 2144              	.L118:
 453:Src/foc.c     **** 
 2145              		.loc 1 453 1 view .LVU476
 2146 0054 7047     		bx	lr
 2147              	.L126:
 450:Src/foc.c     ****     }
 2148              		.loc 1 450 9 is_stmt 1 view .LVU477
 450:Src/foc.c     ****     }
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 55


 2149              		.loc 1 450 15 is_stmt 0 view .LVU478
 2150 0056 9FED057A 		vldr.32	s14, .L127+4
 2151 005a 77EE877A 		vadd.f32	s15, s15, s14
 2152 005e 044B     		ldr	r3, .L127+8
 2153 0060 C3ED007A 		vstr.32	s15, [r3]
 453:Src/foc.c     **** 
 2154              		.loc 1 453 1 view .LVU479
 2155 0064 F6E7     		b	.L118
 2156              	.L128:
 2157 0066 00BF     		.align	2
 2158              	.L127:
 2159 0068 00000000 		.word	.LANCHOR9
 2160 006c 0000B443 		.word	1135869952
 2161 0070 00000000 		.word	.LANCHOR21
 2162              		.cfi_endproc
 2163              	.LFE178:
 2165              		.global	Position_Control_CNT_MAX
 2166              		.global	Speed_Control_CNT_MAX
 2167              		.global	FOC_Flag
 2168              		.global	Position_PID
 2169              		.global	Speed_PID
 2170              		.global	Iq_PID
 2171              		.global	Id_PID
 2172              		.global	Position_Offset
 2173              		.global	Phi
 2174              		.global	Iq_Set
 2175              		.global	Id_Set
 2176              		.global	Last_Mode
 2177              		.global	Board_Mode
 2178              		.global	Motor
 2179              		.comm	iq,4,4
 2180              		.comm	id,4,4
 2181              		.comm	ibeta,4,4
 2182              		.comm	ialpha,4,4
 2183              		.global	input_voltage
 2184              		.global	current
 2185              		.global	current_adc_offset
 2186              		.global	current_adc_value
 2187              		.global	Speed_Set
 2188              		.comm	Speed,4,4
 2189              		.comm	Position_Phase_Degree,4,4
 2190              		.comm	Position_Degree_Set,4,4
 2191              		.comm	Position_Degree,4,4
 2192              		.comm	Position,2,2
 2193              		.global	Duty_Amp
 2194              		.global	Base_Duty
 2195              		.global	Speed_Attitude
 2196              		.global	Base_Speed
 2197              		.section	.bss.Duty_Amp,"aw",%nobits
 2198              		.align	2
 2199              		.set	.LANCHOR19,. + 0
 2202              	Duty_Amp:
 2203 0000 00000000 		.space	4
 2204              		.section	.bss.FOC_Flag,"aw",%nobits
 2205              		.set	.LANCHOR16,. + 0
 2208              	FOC_Flag:
 2209 0000 00       		.space	1
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 56


 2210              		.section	.bss.Id_Set,"aw",%nobits
 2211              		.align	2
 2212              		.set	.LANCHOR10,. + 0
 2215              	Id_Set:
 2216 0000 00000000 		.space	4
 2217              		.section	.bss.current,"aw",%nobits
 2218              		.align	2
 2219              		.set	.LANCHOR14,. + 0
 2222              	current:
 2223 0000 00000000 		.space	8
 2223      00000000 
 2224              		.section	.bss.current_adc_offset,"aw",%nobits
 2225              		.align	2
 2226              		.set	.LANCHOR8,. + 0
 2229              	current_adc_offset:
 2230 0000 00000000 		.space	4
 2231              		.section	.bss.current_adc_value,"aw",%nobits
 2232              		.align	2
 2233              		.set	.LANCHOR7,. + 0
 2236              	current_adc_value:
 2237 0000 00000000 		.space	6
 2237      0000
 2238              		.section	.bss.current_control_cnt.13389,"aw",%nobits
 2239              		.align	2
 2240              		.set	.LANCHOR13,. + 0
 2243              	current_control_cnt.13389:
 2244 0000 00000000 		.space	4
 2245              		.section	.bss.input_voltage,"aw",%nobits
 2246              		.align	2
 2247              		.set	.LANCHOR15,. + 0
 2250              	input_voltage:
 2251 0000 00000000 		.space	4
 2252              		.section	.bss.last_position_phase.13441,"aw",%nobits
 2253              		.align	2
 2254              		.set	.LANCHOR0,. + 0
 2257              	last_position_phase.13441:
 2258 0000 00000000 		.space	4
 2259              		.section	.bss.theta.13437,"aw",%nobits
 2260              		.align	2
 2261              		.set	.LANCHOR21,. + 0
 2264              	theta.13437:
 2265 0000 00000000 		.space	4
 2266              		.section	.data.Base_Duty,"aw"
 2267              		.align	2
 2268              		.set	.LANCHOR20,. + 0
 2271              	Base_Duty:
 2272 0000 CDCCCC3D 		.word	1036831949
 2273              		.section	.data.Base_Speed,"aw"
 2274              		.align	2
 2277              	Base_Speed:
 2278 0000 0080BB44 		.word	1153138688
 2279              		.section	.data.Board_Mode,"aw"
 2280              		.set	.LANCHOR12,. + 0
 2283              	Board_Mode:
 2284 0000 02       		.byte	2
 2285              		.section	.data.Id_PID,"aw"
 2286              		.align	2
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 57


 2287              		.set	.LANCHOR6,. + 0
 2290              	Id_PID:
 2291 0000 00000040 		.word	1073741824
 2292 0004 00000000 		.word	0
 2293 0008 00000040 		.word	1073741824
 2294 000c 00000000 		.space	8
 2294      00000000 
 2295 0014 FFFF7F7F 		.word	2139095039
 2296 0018 00000000 		.space	4
 2297 001c 6F120339 		.word	956502639
 2298 0020 9A99993E 		.word	1050253722
 2299              		.section	.data.Iq_PID,"aw"
 2300              		.align	2
 2301              		.set	.LANCHOR5,. + 0
 2304              	Iq_PID:
 2305 0000 00000040 		.word	1073741824
 2306 0004 00000000 		.word	0
 2307 0008 0000C03F 		.word	1069547520
 2308 000c 00000000 		.space	8
 2308      00000000 
 2309 0014 FFFF7F7F 		.word	2139095039
 2310 0018 00000000 		.space	4
 2311 001c 6F120339 		.word	956502639
 2312 0020 9A99993E 		.word	1050253722
 2313              		.section	.data.Iq_Set,"aw"
 2314              		.align	2
 2315              		.set	.LANCHOR4,. + 0
 2318              	Iq_Set:
 2319 0000 9A99193F 		.word	1058642330
 2320              		.section	.data.Last_Mode,"aw"
 2321              		.set	.LANCHOR11,. + 0
 2324              	Last_Mode:
 2325 0000 02       		.byte	2
 2326              		.section	.data.Motor,"aw"
 2327              		.align	2
 2328              		.set	.LANCHOR9,. + 0
 2331              	Motor:
 2332 0000 07       		.byte	7
 2333 0001 000000   		.space	3
 2334 0004 697FF742 		.word	1123516265
 2335 0008 00       		.byte	0
 2336 0009 00000000 		.space	11
 2336      00000000 
 2336      000000
 2337              		.section	.data.Phi,"aw"
 2338              		.align	2
 2339              		.set	.LANCHOR18,. + 0
 2342              	Phi:
 2343 0000 0000B442 		.word	1119092736
 2344              		.section	.data.Position_Offset,"aw"
 2345              		.align	2
 2346              		.set	.LANCHOR17,. + 0
 2349              	Position_Offset:
 2350 0000 00000443 		.word	1124335616
 2351              		.section	.data.Position_PID,"aw"
 2352              		.align	2
 2353              		.set	.LANCHOR1,. + 0
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 58


 2356              	Position_PID:
 2357 0000 0000A041 		.word	1101004800
 2358 0004 00000000 		.word	0
 2359 0008 CDCCCC3D 		.word	1036831949
 2360 000c 00000000 		.space	8
 2360      00000000 
 2361 0014 FFFF7F7F 		.word	2139095039
 2362 0018 00000000 		.space	4
 2363 001c 6F128339 		.word	964891247
 2364 0020 0000A040 		.word	1084227584
 2365              		.section	.data.Speed_Attitude,"aw"
 2366              		.align	2
 2369              	Speed_Attitude:
 2370 0000 0000FA43 		.word	1140457472
 2371              		.section	.data.Speed_PID,"aw"
 2372              		.align	2
 2373              		.set	.LANCHOR3,. + 0
 2376              	Speed_PID:
 2377 0000 FAEDEB39 		.word	971763194
 2378 0004 00000000 		.word	0
 2379 0008 52491D39 		.word	958220626
 2380 000c 00000000 		.space	8
 2380      00000000 
 2381 0014 FFFF7F7F 		.word	2139095039
 2382 0018 00000000 		.space	4
 2383 001c 6F128339 		.word	964891247
 2384 0020 0000FA44 		.word	1157234688
 2385              		.section	.data.Speed_Set,"aw"
 2386              		.align	2
 2387              		.set	.LANCHOR2,. + 0
 2390              	Speed_Set:
 2391 0000 00803B45 		.word	1161527296
 2392              		.section	.rodata.Position_Control_CNT_MAX,"a"
 2393              		.align	2
 2396              	Position_Control_CNT_MAX:
 2397 0000 02000000 		.word	2
 2398              		.section	.rodata.Speed_Control_CNT_MAX,"a"
 2399              		.align	2
 2402              	Speed_Control_CNT_MAX:
 2403 0000 02000000 		.word	2
 2404              		.text
 2405              	.Letext0:
 2406              		.file 2 "c:\\arm_gcc\\arm-none-eabi\\include\\machine\\_default_types.h"
 2407              		.file 3 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\_stdint.h"
 2408              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 2409              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 2410              		.file 6 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f405xx.h"
 2411              		.file 7 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f4xx.h"
 2412              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 2413              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 2414              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 2415              		.file 11 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_adc.h"
 2416              		.file 12 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim.h"
 2417              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 2418              		.file 14 "Inc/tim.h"
 2419              		.file 15 "Inc/adc.h"
 2420              		.file 16 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\lock.h"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 59


 2421              		.file 17 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\_types.h"
 2422              		.file 18 "c:\\arm_gcc\\lib\\gcc\\arm-none-eabi\\9.2.1\\include\\stddef.h"
 2423              		.file 19 "c:\\arm_gcc\\arm-none-eabi\\include\\sys\\reent.h"
 2424              		.file 20 "c:\\arm_gcc\\arm-none-eabi\\include\\stdlib.h"
 2425              		.file 21 "mylib/uart_ext.h"
 2426              		.file 22 "Src/SVPWM.h"
 2427              		.file 23 "mylib/pid.h"
 2428              		.file 24 "Src/foc.h"
 2429              		.file 25 "c:\\arm_gcc\\arm-none-eabi\\include\\math.h"
 2430              		.file 26 "mylib/debug_utils.h"
 2431              		.file 27 "Inc/utils.h"
 2432              		.file 28 "Drivers/CMSIS/DSP/Include/arm_math.h"
 2433              		.file 29 "mylib/as5047.h"
 2434              		.file 30 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_tim_ex.h"
 2435              		.file 31 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_cortex.h"
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 60


DEFINED SYMBOLS
                            *ABS*:00000000 foc.c
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:22     .text.Get_Speed:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:29     .text.Get_Speed:00000000 Get_Speed
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:131    .text.Get_Speed:00000090 $d
                            *COM*:00000004 Position_Degree
                            *COM*:00000004 Speed
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:144    .text.Position_Control:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:150    .text.Position_Control:00000000 Position_Control
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:247    .text.Position_Control:00000098 $d
                            *COM*:00000004 Position_Degree_Set
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:258    .text.Speed_Control:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:264    .text.Speed_Control:00000000 Speed_Control
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:292    .text.Speed_Control:0000001c $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:300    .text.PID_I_Clear:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:307    .text.PID_I_Clear:00000000 PID_I_Clear
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:336    .text.PID_I_Clear:00000014 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:344    .rodata.Current_ADC_Init.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:348    .text.Current_ADC_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:355    .text.Current_ADC_Init:00000000 Current_ADC_Init
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:451    .text.Current_ADC_Init:00000058 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:458    .text.Foc_Init:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:465    .text.Foc_Init:00000000 Foc_Init
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:555    .text.Foc_Init:0000007c $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:565    .text.Clark_Conv:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:572    .text.Clark_Conv:00000000 Clark_Conv
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:612    .text.Clark_Conv:00000030 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:617    .text.Park_Conv:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:624    .text.Park_Conv:00000000 Park_Conv
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:707    .text.Reverse_Park_Conv:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:714    .text.Reverse_Park_Conv:00000000 Reverse_Park_Conv
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:797    .text.Current_Control:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:804    .text.Current_Control:00000000 Current_Control
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:930    .text.Current_Control:000000b8 $d
                            *COM*:00000004 id
                            *COM*:00000004 iq
                            *COM*:00000004 Position_Phase_Degree
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:944    .text.HAL_ADC_ConvCpltCallback:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:951    .text.HAL_ADC_ConvCpltCallback:00000000 HAL_ADC_ConvCpltCallback
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1424   .text.HAL_ADC_ConvCpltCallback:00000308 $d
                            *COM*:00000004 ibeta
                            *COM*:00000004 ialpha
                            *COM*:00000002 Position
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1465   .rodata.Test_Direction.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1469   .text.Test_Direction:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1476   .text.Test_Direction:00000000 Test_Direction
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1614   .text.Test_Direction:0000008c $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1625   .text.Measure_Res:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1632   .text.Measure_Res:00000000 Measure_Res
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1663   .text.Measure_Res:00000018 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1670   .rodata.Detect_Encoder.str1.4:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1687   .text.Detect_Encoder:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:1694   .text.Detect_Encoder:00000000 Detect_Encoder
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2063   .text.Detect_Encoder:000001c4 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2086   .text.Openloop_Runing:00000000 $t
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2093   .text.Openloop_Runing:00000000 Openloop_Runing
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2159   .text.Openloop_Runing:00000068 $d
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 61


C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2396   .rodata.Position_Control_CNT_MAX:00000000 Position_Control_CNT_MAX
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2402   .rodata.Speed_Control_CNT_MAX:00000000 Speed_Control_CNT_MAX
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2208   .bss.FOC_Flag:00000000 FOC_Flag
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2356   .data.Position_PID:00000000 Position_PID
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2376   .data.Speed_PID:00000000 Speed_PID
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2304   .data.Iq_PID:00000000 Iq_PID
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2290   .data.Id_PID:00000000 Id_PID
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2349   .data.Position_Offset:00000000 Position_Offset
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2342   .data.Phi:00000000 Phi
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2318   .data.Iq_Set:00000000 Iq_Set
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2215   .bss.Id_Set:00000000 Id_Set
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2324   .data.Last_Mode:00000000 Last_Mode
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2283   .data.Board_Mode:00000000 Board_Mode
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2331   .data.Motor:00000000 Motor
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2250   .bss.input_voltage:00000000 input_voltage
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2222   .bss.current:00000000 current
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2229   .bss.current_adc_offset:00000000 current_adc_offset
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2236   .bss.current_adc_value:00000000 current_adc_value
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2390   .data.Speed_Set:00000000 Speed_Set
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2202   .bss.Duty_Amp:00000000 Duty_Amp
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2271   .data.Base_Duty:00000000 Base_Duty
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2369   .data.Speed_Attitude:00000000 Speed_Attitude
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2277   .data.Base_Speed:00000000 Base_Speed
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2198   .bss.Duty_Amp:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2209   .bss.FOC_Flag:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2211   .bss.Id_Set:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2218   .bss.current:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2225   .bss.current_adc_offset:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2232   .bss.current_adc_value:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2239   .bss.current_control_cnt.13389:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2243   .bss.current_control_cnt.13389:00000000 current_control_cnt.13389
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2246   .bss.input_voltage:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2253   .bss.last_position_phase.13441:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2257   .bss.last_position_phase.13441:00000000 last_position_phase.13441
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2260   .bss.theta.13437:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2264   .bss.theta.13437:00000000 theta.13437
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2267   .data.Base_Duty:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2274   .data.Base_Speed:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2286   .data.Id_PID:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2300   .data.Iq_PID:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2314   .data.Iq_Set:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2327   .data.Motor:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2338   .data.Phi:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2345   .data.Position_Offset:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2352   .data.Position_PID:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2366   .data.Speed_Attitude:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2372   .data.Speed_PID:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2386   .data.Speed_Set:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2393   .rodata.Position_Control_CNT_MAX:00000000 $d
C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s:2399   .rodata.Speed_Control_CNT_MAX:00000000 $d

UNDEFINED SYMBOLS
__aeabi_f2d
__aeabi_dmul
__aeabi_dsub
__aeabi_d2f
PID_Control
ARM GAS  C:\Users\ncer\AppData\Local\Temp\ccgNcWyn.s 			page 62


HAL_Delay
uprintf_polling
AS5047_Set_Direction
HAL_ADC_Start_DMA
HAL_TIM_Base_Start
HAL_TIM_PWM_Start
HAL_TIMEx_PWMN_Start
HAL_NVIC_SetPriority
HAL_NVIC_EnableIRQ
HAL_TIM_Base_Start_IT
hadc1
htim8
htim1
htim7
arm_sin_cos_f32
atan2f
sqrtf
SVPWM
HAL_GPIO_WritePin
Get_Position
Position_to_Rad_Dgree
send_debug_wave
Set_Vector
arm_cos_f32
wg1
wg2
U0
U4
